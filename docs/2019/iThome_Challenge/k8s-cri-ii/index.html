<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-2019/iThome_Challenge/k8s-cri-ii" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Kubernetes &amp; CRI (II) - containerd | hwchiu learning note</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://hwchiu.com/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://hwchiu.com/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://hwchiu.com/docs/2019/iThome_Challenge/k8s-cri-ii"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Kubernetes &amp; CRI (II) - containerd | hwchiu learning note"><meta data-rh="true" name="description" content="本文介紹了 `containerd 的概念，並且嘗試建置一個基於 containerd 的 kubernetes cluster, 讓大家體驗看看佈樁 docker 也可以運行 kubernetes 的使用方式，同時也可以學習到是如何透過設定來改變 kubernetes 這一連串的行為的。"><meta data-rh="true" property="og:description" content="本文介紹了 `containerd 的概念，並且嘗試建置一個基於 containerd 的 kubernetes cluster, 讓大家體驗看看佈樁 docker 也可以運行 kubernetes 的使用方式，同時也可以學習到是如何透過設定來改變 kubernetes 這一連串的行為的。"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hwchiu.com/docs/2019/iThome_Challenge/k8s-cri-ii"><link data-rh="true" rel="alternate" href="https://hwchiu.com/docs/2019/iThome_Challenge/k8s-cri-ii" hreflang="en"><link data-rh="true" rel="alternate" href="https://hwchiu.com/docs/2019/iThome_Challenge/k8s-cri-ii" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="hwchiu learning note RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="hwchiu learning note Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XCGL7X3W07"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XCGL7X3W07",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.a4f4719e.css">
<link rel="preload" href="/assets/js/runtime~main.63e3ede8.js" as="script">
<link rel="preload" href="/assets/js/main.2d5208eb.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Hwchiu" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="Hwchiu" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">HWCHIU 學習筆記</b></a><a class="navbar__item navbar__link" href="/about">我是誰</a><a class="navbar__item navbar__link" href="/">短篇筆記</a><a class="navbar__item navbar__link" href="/tags">短篇筆記-分類</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/2023">長篇技術文</a><a class="navbar__item navbar__link" href="/docs/tags">長篇技術文-分類</a><a class="navbar__item navbar__link" href="/course">線上課程</a><a class="navbar__item navbar__link" href="/public_sharing">演講紀錄</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/2023">2023</a><button aria-label="Toggle the collapsible sidebar category &#x27;2023&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/2022">2022</a><button aria-label="Toggle the collapsible sidebar category &#x27;2022&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/2021">2021</a><button aria-label="Toggle the collapsible sidebar category &#x27;2021&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/2020">2020</a><button aria-label="Toggle the collapsible sidebar category &#x27;2020&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/2019">2019</a><button aria-label="Toggle the collapsible sidebar category &#x27;2019&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/aks-cni-i">Azure Kubernetes Service (AKS) - CNI (I)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/aws-profile">Management AWS Profiles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/b4-after">[閱讀筆記] B4 and After: Managing Hierarchy, partitioning, and Asymmetry for Availability and Scale in Google&#x27;s Software-Defined WAN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/circleci">CircleCI 使用經驗談</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/2019/iThome_Challenge/k8s-design">iThome_Challenge</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/k8s-design">淺談 Kubernetes 設計原理</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/container-design-i">淺談 Container 實現原理, 以 Docker 為例(I)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/summary">完賽感想</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/container-design-ii">淺談 Container 實現原理, 以 Docker 為例(II)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/container-design-iii">淺談 Container 實現原理, 以 Docker 為例(III)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/k8s-cri-i">Kubernetes &amp; CRI (I)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/2019/iThome_Challenge/k8s-cri-ii">Kubernetes &amp; CRI (II) - containerd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/k8s-cri-o">Container Runtime - CRI-O</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/container-runtime-security-container">Container Runtime - Security Container</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/container-runtime-vm">Container Runtime - Virtual Machine</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/cni">Container Network Interface 介紹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/k8s-cni">kubernetes 與 CNI 的互動</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/cni-golnag">使用 golang 開發第一個 CNI 程式</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/cni-ipam">初探 CNI 的 IP 分配問題 (IPAM)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/cni-flannel-i">CNI - Flannel - 安裝設定篇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/cni-flannel-ii">CNI - Flannel - IP 管理篇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/cni-flannel-iii">CNI - Flannel - VXLAN 封包運作篇</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/cni-experience">CNI 閒談</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/csi">Container Storage Interface 基本介紹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/csi-ii">Container Storage Interface 標準介紹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/csi-iii">Container Storage Interface 與 kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/csi-nfs">Container Storage Interface(CSI) - NFS 初體驗</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/csi-other">CSI 雜談</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/k8s-device-plugin"> Device Plugin - Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/k8s-device-plugin-implement">Device Plugin - Implementation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/k8s-device-plugin-rdma">Kubernetes - Device Plugin - RDMA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/k8s-device-plugin-sriov">Kubernetes - Device Plugin - SRIOV</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/k8s-operator-pattern">Kubernetes - Operator Pattern 介紹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/k8s-service-catalog">Service Catalog</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iThome_Challenge/k8s-security">Kubernetes Container Security 探討</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/ingress-1">Introduction to Kubernetes Ingress (Nginx)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/iptables-masquerade">Linux NAT Masquerade 研究(上)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/k8s-concept">你到底知不知道什麼是 Kubernetes?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2019/keel">[DevOps] 基於 Kubernetes 的自動部屬流程 - Keel</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/2018">2018</a><button aria-label="Toggle the collapsible sidebar category &#x27;2018&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/2017">2017</a><button aria-label="Toggle the collapsible sidebar category &#x27;2017&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/2016">2016</a><button aria-label="Toggle the collapsible sidebar category &#x27;2016&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/2015">2015</a><button aria-label="Toggle the collapsible sidebar category &#x27;2015&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/2014">2014</a><button aria-label="Toggle the collapsible sidebar category &#x27;2014&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/2013">2013</a><button aria-label="Toggle the collapsible sidebar category &#x27;2013&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/2019"><span itemprop="name">2019</span></a><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">iThome_Challenge</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Kubernetes &amp; CRI (II) - containerd</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>前言</h1><p>前篇文章中跟大家探討了 <code>kubernetes</code> 內關於容器運行標準化的架構，透過 <code>Container Runtime Interface</code> 與各式各樣的 <code>Container Runtime</code> 解決方案溝通，可以讓 <code>kubernetes</code> 本身只需要專注於 <code>kubelet</code> 以及 <code>CRI 標準</code> 的互動，第三方開發者則可以根據需求開發出各式各樣不同的產品，只要能夠滿足 <code>CRI 標準</code> 即可。</p><p>就我所知，目前相容於 <code>CRI</code> 的解決方案可根據其架構分成三大類，分別是</p><ul><li>真的是輕量級虛擬化的容器</li><li>背後是虛擬機器，但是卻運作起來像輕量級虛擬化的容器</li><li>真的是傳統虛擬機器</li></ul><p>接下來的數篇文章會根據每個類別詳細介紹一種解決方案，並探討設計理念與架構，與此同時大家也可以思考自己的環境是不是有可能可以搭載其他的解決方案，而非永遠使用 <code>Docker</code> ?</p><p>本篇會先透過一個簡單的環境實驗來帶過如何建置一個使用 <code>containerd</code> 的 <code>kubernetes</code> 環境，可以體驗到不安裝 <code>docker</code> 也可以運行的 <code>kubernetes</code> 叢集， 同時之後若安裝了 <code>docker</code> 也可以觀察到是否真的如上篇文章所說， <code>docker</code> 與 <code>kubernetes</code> 本身創造出來的 <code>container</code> 是互相不干涉的。</p><h1>環境建置</h1><p>接下來的建置環境與步驟是參考 <a href="https://github.com/containerd/cri/tree/master/contrib/ansible" target="_blank" rel="noopener noreferrer">Containerd GitHub</a> 濃縮的。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="環境需求">環境需求<a href="#環境需求" class="hash-link" aria-label="Direct link to 環境需求" title="Direct link to 環境需求">​</a></h2><ul><li>OS: Ubuntu 16.04<ul><li>18.04 會因為 <code>kubernetes deb</code> 相關的問題導致套件更新失敗，建議先基於 <code>16.04</code> 測試即可</li></ul></li><li>Python: 2.7+</li><li>Ansible: 2.4+<ul><li>有沒有使用 <code>ansible</code> 都無所謂，因為我們會拆解裡面的步驟，去看看全部的安裝步驟</li><li></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="環境安裝">環境安裝<a href="#環境安裝" class="hash-link" aria-label="Direct link to 環境安裝" title="Direct link to 環境安裝">​</a></h2><p>環境的部分只有包括 <code>containerd</code> 的相依套件，並不包含 <code>kubernetes</code> 叢集本身，但是有包含 <code>kubeadm</code>, <code>kubectl</code>, <code>kubelet</code> 相關套件。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ansible-版本">Ansible 版本<a href="#ansible-版本" class="hash-link" aria-label="Direct link to Ansible 版本" title="Direct link to Ansible 版本">​</a></h3><p>基本上官方文件已經將相關的步驟都建置完畢，本身只需要準備 <code>hosts</code> 的檔案即可，該 <code>ansible playbook</code> 支援 <code>Ubuntu</code> 以及 <code>CentOS</code> 兩套發行版本。</p><p>首先在 <code>ansible host</code> 執行下列指令抓取相關的 <code>ansible-playbook</code></p><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git clone https://github.com/containerd/cri</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd ./cri/contrib/ansible</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>接下來根據需求產生對應的 <code>hosts</code> 檔案，裡面放置要被安裝的機器，或是直接採用 <code>localhost</code> 的方式再本機運行該 <code>playbook</code> 即可。
這部分比較屬於 <code>ansible</code> 的方式，不熟悉的讀者可以自行尋找資源看看如何運行，或是放棄採用 <code>ansible</code>, 而是逐條逐條的自行安裝</p><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ansible-playbook -i hosts cri-containerd.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>順利跑完應該會看到類似下圖的結果</p><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TASK [Create a directory for cni binary] ***********************************************************************************************************************************$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">changed: [localhost]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TASK [Create a directory for cni config files] *****************************************************************************************************************************$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">changed: [localhost]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TASK [Create a directory for containerd config] ****************************************************************************************************************************$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">changed: [localhost]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TASK [Start Containerd] ****************************************************************************************************************************************************$changed: [localhost]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TASK [Load br_netfilter kernel module] *************************************************************************************************************************************$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">changed: [localhost]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TASK [Set bridge-nf-call-iptables] *****************************************************************************************************************************************$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">changed: [localhost]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TASK [Set ip_forward] ******************************************************************************************************************************************************$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">changed: [localhost]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TASK [Check kubelet args in kubelet config] ********************************************************************************************************************************$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">changed: [localhost]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TASK [Add runtime args in kubelet conf] ************************************************************************************************************************************$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">skipping: [localhost]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TASK [Start Kubelet] *******************************************************************************************************************************************************$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">changed: [localhost]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TASK [Pre-pull pause container image] **************************************************************************************************************************************$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">changed: [localhost]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PLAY RECAP ******************************************************************************************************************************************************************</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="手動安裝版本">手動安裝版本<a href="#手動安裝版本" class="hash-link" aria-label="Direct link to 手動安裝版本" title="Direct link to 手動安裝版本">​</a></h3><p>如果不想透過 <code>ansible</code> 一鍵安裝完畢，接下來透過拆解該 <code>ansible playbook</code> 就可以知道實際上要做哪些步驟來建置 <code>containerd</code> 的環境。</p><ol><li>讀取下列變數 <code>var/vars.yaml</code><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- containerd_release_version: 1.1.0-rc.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- cni_bin_dir: /opt/cni/bin/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- cni_conf_dir: /etc/cni/net.d/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>第一個指明 <code>containerd</code> 的版本後，後續兩個變數則是 <code>CNI (Container Network Interface)</code> 會用到的路徑，之後的文章會細部探討 <code>CNI</code> 的設計與使用。</li><li>根據發行版本讀取不同的檔案來安裝相關套件 (Ubuntu 為範例)<ul><li>unzip</li><li>tar</li><li>apt-transport-https</li><li>btrfs-tools</li><li>libseccomp2</li><li>socat</li><li>util-linux</li></ul></li><li>安裝 <code>kubernetes</code> 會用到的相關工具<ul><li>kubelet</li><li>kubeadm</li><li>kubectl</li></ul></li><li>安裝 <code>containerd</code> 會用到的相關工具<ul><li>cri-containerd</li><li>來源網址是 <a href="https://storage.googleapis.com/cri-containerd-release" target="_blank" rel="noopener noreferrer">https://storage.googleapis.com/cri-containerd-release</a>, 點進去可以看到各種不同版本的 <code>cri-containerd</code>.</li><li>解壓縮該安裝檔案後可以看到有下列內容，包含了 <code>systemd</code> 的設定，相關的執行檔案。</li></ul></li></ol><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./opt/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./opt/containerd/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./opt/containerd/cluster/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./opt/containerd/cluster/gce/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./opt/containerd/cluster/gce/cloud-init/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./opt/containerd/cluster/gce/cloud-init/node.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./opt/containerd/cluster/gce/cloud-init/master.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./opt/containerd/cluster/gce/configure.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./opt/containerd/cluster/gce/env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./opt/containerd/cluster/version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./opt/containerd/cluster/health-monitor.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./usr/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./usr/local/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./usr/local/sbin/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./usr/local/sbin/runc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./usr/local/bin/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./usr/local/bin/crictl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./usr/local/bin/containerd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./usr/local/bin/containerd-stress</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./usr/local/bin/critest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./usr/local/bin/containerd-release</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./usr/local/bin/containerd-shim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./usr/local/bin/ctr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./etc/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./etc/systemd/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./etc/systemd/system/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./etc/systemd/system/containerd.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./etc/crictl.yaml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="7"><li>透過 <code>systemd</code> 啟動 <code>containerd</code></li><li>設定 <code>netfilter</code> 相關設定，讓 <code>kernel</code> 啟動相關功能<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">- br_netfilter -&gt; bridge 層級啟動 netfilter (ebtables)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- bridge-nf-call-iptables -&gt; bridge 層級也會去呼叫 iptables 處理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- ip_forward -&gt; 轉發 ip 封包</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>這些功能基本上以前安裝 <code>docker</code> 的時候都會幫忙處理，所以基本上都不會特別注意到</li><li>接下來就是重頭戲了，如何讓 <code>kubernetes</code> 知道要使用 <code>containerd</code> 作為其 <code>Container Runtime</code> 而非使用 <code>dockershim</code> 來銜接 <code>docker</code>.
根據 <a href="https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/" target="_blank" rel="noopener noreferrer">官方文件</a>， <code>kubelet</code> 裡面有下列的參數可以設定<blockquote><p>--container-runtime string
The container runtime to use. Possible values: &#x27;docker&#x27;, &#x27;remote&#x27;, &#x27;rkt(deprecated)&#x27;. (default &quot;docker&quot;)
--container-runtime-endpoint string
<!-- -->[Experimental]<!-- --> The endpoint of remote runtime service. Currently unix socket is supported on Linux, and tcp is supported on windows.</p></blockquote></li></ol><p>其中 <code>container-runtime</code> 可以使用三種來處理，分別是內建的 <code>docker</code>, <code>rkt</code> 以及客製化的 <code>remote</code>.
當上述選擇了 <code>remote</code> 後，也必須要一起設定 <code>container-runtime-endpoint</code> 告訴 <code>kubelet</code> 這時候要怎麼跟非內建的 <code>container runtime</code> 溝通。</p><p>因此安裝過程中，該 <code>ansible playbook</code> 就會嘗試修改 <code>kubelet</code> 的啟動參數，這部分因為整個安裝過程都是透過 <code>kubeadm</code> 去架設 <code>kubernetes cluster</code>, 所以最後是修改 <code>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code> 這個檔案. 關於 <code>kubeadm</code> 與 <code>kubelet</code> 彼此之間的設定過程可以參考下列文章 <a href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/kubelet-integration/#the-kubelet-drop-in-file-for-systemd" target="_blank" rel="noopener noreferrer">kubeadm/kubelet-integration</a></p><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vagrant@k8s-dev:~$ sudo cat /etc/systemd/system/kubelet.service.d/10-kubeadm.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Note: This dropin only works with kubeadm and kubelet v1.11+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[Service]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Environment=&quot;KUBELET_EXTRA_ARGS= --runtime-cgroups=/system.slice/containerd.service --container-runtime=remote --runtime-request-timeout=15m --container-runtime-endpoint=unix:///run/containerd/containerd.sock&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Environment=&quot;KUBELET_KUBECONFIG_ARGS=--bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Environment=&quot;KUBELET_CONFIG_ARGS=--config=/var/lib/kubelet/config.yaml&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This is a file that &quot;kubeadm init&quot; and &quot;kubeadm join&quot; generates at runtime, populating the KUBELET_KUBEADM_ARGS variable dynamically</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EnvironmentFile=-/var/lib/kubelet/kubeadm-flags.env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This is a file that the user can use for overrides of the kubelet args as a last resort. Preferably, the user should use</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># the .NodeRegistration.KubeletExtraArgs object in the configuration files instead. KUBELET_EXTRA_ARGS should be sourced from this file.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EnvironmentFile=-/etc/default/kubelet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExecStart=</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ExecStart=/usr/bin/kubelet $KUBELET_KUBECONFIG_ARGS $KUBELET_CONFIG_ARGS $KUBELET_KUBEADM_ARGS $KUBELET_EXTRA_ARGS</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>當我們實際觀察這個檔案，可以發現裡面關於環境變數的部分加入了下列選項，這時候我們就明瞭到底 <code>kubernetes</code> 之後是如何跟 <code>containerd</code> 溝通的
<code>--container-runtime=remote --runtime-request-timeout=15m --container-runtime-endpoint=unix:///run/containerd/containerd.sock&quot;</code></p><ol start="10"><li>最後就是啟動 <code>kubelet</code> 將基本的服務起來</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kubernetes-cluster">Kubernetes Cluster<a href="#kubernetes-cluster" class="hash-link" aria-label="Direct link to Kubernetes Cluster" title="Direct link to Kubernetes Cluster">​</a></h2><p>一切都準備就緒後，接下來非常簡單的透過 <code>kubeadm</code> 的方式來創建 <code>kubernetes cluster</code>.
這個範例中我採用 <code>flannel</code> 作為 CNI, 之後也會有文章詳細介紹 <code>Flannel</code> 的運作原理。</p><p>依序執行下列指令將 <code>kubernetes cluster</code> 給建立起來，並安裝 <code>CNI</code> 同時也打開
<code>taint</code> 讓 <code>master node</code> 也可以部署 <code>Pod</code>.</p><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo swapoff -a &amp;&amp; sudo sysctl -w vm.swappiness=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo kubeadm init --pod-network-cidr=10.244.0.0/16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p $HOME/.kube</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown $(id -u):$(id -g) $HOME/.kube/config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/a70459be0084506e4ec919aa1c114638878db11b/Documentation/kube-flannel.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl taint nodes --all node-role.kubernetes.io/master-</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>這時候使用簡單的工具確認 <code>kubernetes</code> 有正常起來即可</p><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vagrant@k8s-dev:~/cri/contrib/ansible$ kubectl get pods --all-namespaces</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAMESPACE     NAME                          READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   coredns-5c98db65d4-ghzpl      0/1     Running   0          26s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   coredns-5c98db65d4-thsdq      0/1     Running   0          26s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-flannel-ds-amd64-ztqgs   1/1     Running   0          14s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kube-system   kube-proxy-jfs66              1/1     Running   0          26s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>觀察</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="containerd">Containerd<a href="#containerd" class="hash-link" aria-label="Direct link to Containerd" title="Direct link to Containerd">​</a></h2><p>接下來我們要透過不同的工具來觀察當使用 <code>containerd</code> 作為部署時有什麼不同</p><p>由於此時我們不是透過 <code>docker</code> 來管理整個 <code>kubernetes</code> 底層需要的 <code>container</code>，而是透過 <code>kubelet &amp; CRI &amp; containerd</code> 來管理。
所以這時候就不能透過 <code>docker ps</code> 或是 <code>docker images</code> 等指令來看相關的 <code>container</code> 資源，取而代之的是 <code>crictl</code> 這個在前面步驟伴隨 <code>containerd</code> 一起安裝到系統內的工具。</p><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vagrant@k8s-dev:~/cri/contrib/ansible$ crictl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   crictl - client for CRI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">USAGE:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   crictl [global options] command [command options] [arguments...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">VERSION:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1.0.0-beta.0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COMMANDS:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     attach        Attach to a running container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     create        Create a new container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     exec          Run a command in a running container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     version       Display runtime version information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     images        List images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     inspect       Display the status of one or more containers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     inspecti      Return the status of one ore more images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     inspectp      Display the status of one or more pod sandboxes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     logs          Fetch the logs of a container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     port-forward  Forward local port to a pod sandbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ps            List containers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     pull          Pull an image from a registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     runp          Run a new pod sandbox</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     rm            Remove one or more containers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     rmi           Remove one or more images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     rmp           Remove one or more pod sandboxes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     pods          List pod sandboxes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     start         Start one or more created containers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     info          Display information of the container runtime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     stop          Stop one or more running containers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     stopp         Stop one or more running pod sandboxes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     update        Update one or more running containers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     config        Get and set crictl options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     stats         List container(s) resource usage statistics</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     completion    Output bash shell completion code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     help, h       Shows a list of commands or help for one command</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GLOBAL OPTIONS:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --config value, -c value            Location of the client config file (default: &quot;/etc/crictl.yaml&quot;) [$CRI_CONFIG_FILE]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --debug, -D                         Enable debug mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --image-endpoint value, -i value    Endpoint of CRI image manager service [$IMAGE_SERVICE_ENDPOINT]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --runtime-endpoint value, -r value  Endpoint of CRI container runtime service (default: &quot;unix:///var/run/dockershim.sock&quot;) [$CONTAINER_RUNTIME_ENDPOINT]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --timeout value, -t value           Timeout of connecting to the server (default: 10s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --help, -h                          show help</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   --version, -v                       print the version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>說明非常簡單，就是 <code>CRI</code> 命令列，其預設的設定檔案位於 <code>/etc/crictl.yaml</code></p><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vagrant@k8s-dev:~/cri/contrib/ansible$ cat /etc/crictl.yaml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">runtime-endpoint: /run/containerd/containerd.sock</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>所以接下來呼叫的任何 <code>crictl</code> 指令都會跟 <code>containerd</code> 互動來取得回應，我們就根據上面的提示來試試看各種指令</p><p>基於 <code>kubernetes POD</code> 概念的資源顯示</p><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vagrant@k8s-dev:~/cri/contrib/ansible$ sudo crictl pods                                                                                                PODSANDBOX ID       CREATED             STATE               NAME                              NAMESPACE           ATTEMPT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4ed054a456e96       17 minutes ago      SANDBOX_READY       coredns-5c98db65d4-ghzpl          kube-system         0                                    c5209a01e0936       17 minutes ago      SANDBOX_READY       coredns-5c98db65d4-thsdq          kube-system         0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0a771e9912232       18 minutes ago      SANDBOX_READY       kube-flannel-ds-amd64-ztqgs       kube-system         0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0642c904298c8       18 minutes ago      SANDBOX_READY       kube-proxy-jfs66                  kube-system         0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">46039553a0fcc       18 minutes ago      SANDBOX_READY       kube-scheduler-k8s-dev            kube-system         0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ec6d7cde198cc       18 minutes ago      SANDBOX_READY       kube-controller-manager-k8s-dev   kube-system         0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">be0bc17da244d       18 minutes ago      SANDBOX_READY       etcd-k8s-dev                      kube-system         0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">490d8b240d8ca       18 minutes ago      SANDBOX_READY       kube-apiserver-k8s-dev            kube-system         0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>相關的 <code>container images</code>, 這些 <code>images</code> 再之前都是透過 <code>docker pull</code> 等方式安裝，如今我們系統內完全不裝 <code>docker</code> 也是可以使用，這一切都是仰賴 <code>OCI</code> 標準的制定外加 <code>containerd</code> 的幫忙。</p><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vagrant@k8s-dev:~/cri/contrib/ansible$ sudo crictl images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">IMAGE                                TAG                 IMAGE ID            SIZE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k8s.gcr.io/coredns                   1.3.1               eb516548c180f       12.3MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k8s.gcr.io/etcd                      3.3.10              2c4adeb21b4ff       76.2MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k8s.gcr.io/kube-apiserver            v1.15.3             5eb2d3fc7a44e       49.3MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k8s.gcr.io/kube-controller-manager   v1.15.3             e77c31de55475       47.8MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k8s.gcr.io/kube-proxy                v1.15.3             232b5c7931462       30.1MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k8s.gcr.io/kube-scheduler            v1.15.3             703f9c69a5d57       29.9MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k8s.gcr.io/pause                     3.1                 da86e6ba6ca19       317kB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">quay.io/coreos/flannel               v0.11.0-amd64       8a9c4ced3ff92       16.9MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vagrant@k8s-dev:~/cri/contrib/ansible$ sudo crictl ps</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>接下來看看運行的 <code>container</code>, 其結果跟 <code>docker ps</code> 非常相似，使用起來幾乎沒有任何違和感，我覺得設定 <code>alias docker=crictl</code> 都不會有什麼錯覺?</p><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vagrant@k8s-dev:~/cri/contrib/ansible$ sudo crictl ps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER ID        IMAGE                                                                     CREATED             STATE               NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         ATTEMPT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1cf00f473d03a       sha256:eb516548c180f8a6e0235034ccee2428027896af16a509786da13022fe95fe8c   19 minutes ago      CONTAINER_RUNNING   coredns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">221b815ca1f56       sha256:eb516548c180f8a6e0235034ccee2428027896af16a509786da13022fe95fe8c   19 minutes ago      CONTAINER_RUNNING   coredns</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">f35552b98abc1       sha256:8a9c4ced3ff92c63c446d55c2353c42410c78b497a0483d4048e8d30ebe37058   19 minutes ago      CONTAINER_RUNNING   kube-flannel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">8eafd7980b1d3       sha256:232b5c79314628fbc788319e2dff191f4d08e38962e42ebd31b55b52fecd70ec   19 minutes ago      CONTAINER_RUNNING   kube-proxy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">feb2ed1caa423       sha256:2c4adeb21b4ff8ed3309d0e42b6b4ae39872399f7b37e0856e673b13c4aba13d   20 minutes ago      CONTAINER_RUNNING   etcd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">00be90f2a7ac0       sha256:703f9c69a5d578378a022dc75d0c242d599422a1b7cc9cf5279b49d39dc7ca08   20 minutes ago      CONTAINER_RUNNING   kube-scheduler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">e16c5a24ff09d       sha256:e77c31de554758f3f03e78e124a914b7d86de7d7cf3d677c9b720efb90a833f9   20 minutes ago      CONTAINER_RUNNING   kube-controller-m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">anager   0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fbe374eb60712       sha256:5eb2d3fc7a44e3a8399256d4b60153a1a59165e70334a1c290fcbd33a9a9d8a7   20 minutes ago      CONTAINER_RUNNING   kube-apiserver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>除了 <code>container</code> 本身的管理外，我們來看一下系統內運行的應用程式, 可以觀察到系統上有一個 <code>containerd</code> 正在運行，同時 <code>kuberlet</code> 內關於 <code>container-runtime</code> 的參數有被修改。</p><p>此外對於每個運作的 <code>container</code>, <code>containetd</code> 都會產生一個 <code>containerd-shim</code> 來運作。</p><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vagrant@k8s-dev:~/cri/contrib/ansible$ ps -axo command | grep containerd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/local/bin/containerd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/kubelet --bootstrap-kubeconfig=/etc/kubernetes/bootstrap-kubelet.conf --kubeconfig=/etc/kubernetes/kubelet.conf --config=/var/lib/kubelet/conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ig.yaml --container-runtime=remote --container-runtime-endpoint=/run/containerd/containerd.sock --runtime-cgroups=/system.slice/containerd.service --co</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ntainer-runtime=remote --runtime-request-timeout=15m --container-runtime-endpoint=unix:///run/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">containerd-shim -namespace k8s.io -workdir /var/lib/containerd/io.containerd.runtime.v1.linux/k8s.io/490d8b240d8ca4c0df7d8440c5002ca795bddb989fb8bc6de2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0da78394eb8ce6 -address /run/containerd/containerd.sock -containerd-binary /usr/local/bin/containerd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.....</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="docker">Docker<a href="#docker" class="hash-link" aria-label="Direct link to Docker" title="Direct link to Docker">​</a></h2><p>為了驗證之前說明是否 <code>dockerd</code> 與 <code>kubelet</code> 共用 <code>containerd</code> 但是彼此資源是互相隔離的，這時候我們來安裝一下 <code>docker</code> 並且於背景運行一個 <code>container</code> 試試看</p><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo docker run -d hwchiu/netutils</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>接下來我們使用 <code>docker</code> 指令針對上述的操作都進行一次，來比較看看</p><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vagrant@k8s-dev:~$ sudo docker images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hwchiu/netutils     latest              a0d1dad34d58        13 months ago       222MB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vagrant@k8s-dev:~$ sudo docker ps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">320b653e39d8        hwchiu/netutils     &quot;/bin/bash ./entrypo…&quot;   15 minutes ago      Up 15 minutes                           inspiring_haslett</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>非常乾淨簡單，完全看不到任何 <code>kubernetes</code> 用到的容器資源，此外我們再度透過 ｀<code>ps</code> 觀察</p><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">containerd-shim -namespace moby -workdir /var/lib/containerd/io.containerd.runtime.v1.linux/moby/320b653e39d8164e3033f1eec079c7772a10e703d24bb7f39f7bdf26fe084fe5 -address /run/containerd/containerd.sock -containerd-binary /usr/local/bin/containerd -runtime-root /var/run/docker/runtime-runc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>首先，可以看到 <code>dockerd</code> 這時候也透過參數的方式去連接 <code>containerd</code>, 另外可以看到針對我上述的 <code>docker image</code> 所產生的 <code>containerd-shim</code> 與 <code>kubernetes</code> 產生的 <code>containerd-shim</code> 有明顯的參數不同</p><ol><li>-namespace moby v.s k8s.io</li><li>workdir 不同</li><li>-runtime-root /var/run/docker/runtime-runc</li></ol><p>此外我們也可以透過 <code>containerd cli(ctr) and containerd</code> 來觀察更多有趣的資訊</p><p>首先可以看到對於 <code>containerd</code> 的確有不同的 <code>namespace</code>，也的確如上面所觀察到的是 <code>moby</code> 與 <code>k8s.io</code></p><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vagrant@k8s-dev:~$ sudo ctr namespaces ls</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME   LABELS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">k8s.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">moby</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>此外我們也可以看到不少關於 containerd 預設的設定，預設情況下 <code>linux</code> 環境中都是採用 <code>runc</code> 作為 <code>OCI Runtime Spec</code> 的解決方案。
而 <code>kubelet</code> 透過 <code>CRI</code> 與 <code>docker</code> 最後選擇都是會採取 <code>plugin.linux</code> 的設定，所以兩者背後最後都是透過 <code>runc</code> 來創建 <code>Container</code>。</p><div class="language-bash= codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash= codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo containerd config default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [plugins.cri]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stream_server_address = &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stream_server_port = &quot;10010&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    enable_selinux = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sandbox_image = &quot;k8s.gcr.io/pause:3.1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    stats_collect_period = 10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    systemd_cgroup = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [plugins.cri.containerd]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      snapshotter = &quot;overlayfs&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      [plugins.cri.containerd.default_runtime]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        runtime_type = &quot;io.containerd.runtime.v1.linux&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        runtime_engine = &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        runtime_root = &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      [plugins.cri.containerd.untrusted_workload_runtime]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        runtime_type = &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        runtime_engine = &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        runtime_root = &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  [plugins.linux]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    shim = &quot;containerd-shim&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime = &quot;runc&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runtime_root = &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    no_shim = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    shim_debug = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Summary</h1><p>本文中我們簡述了如何建置一套基於 <code>containerd</code> 而非 <code>docker</code> 的 <code>kubernetes cluster</code>, 並且透過相關指令與工具來觀察在此設定下，<code>kubernetes</code>,<code>containerd</code>, <code>dockerd</code> 等彼此的交互關係，可以更加深對於 <code>CRI, OCI</code> 等概念的理解。</p><p>kubelet -&gt; containerd -&gt; containetrd-shin(k8s.io) -&gt; runc</p><p>docker client -&gt; docker enginer -&gt; containerd -&gt; containerd-shim(moby) -&gt; runc</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/kubernetes">Kubernetes</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/cri">CRI</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/container">Container</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/i-thome">iThome</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> by <b>HungWei Chiu</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/2019/iThome_Challenge/k8s-cri-i"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Kubernetes &amp; CRI (I)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/2019/iThome_Challenge/k8s-cri-o"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Container Runtime - CRI-O</div></a></nav><hr><br></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#環境需求" class="table-of-contents__link toc-highlight">環境需求</a></li><li><a href="#環境安裝" class="table-of-contents__link toc-highlight">環境安裝</a><ul><li><a href="#ansible-版本" class="table-of-contents__link toc-highlight">Ansible 版本</a></li><li><a href="#手動安裝版本" class="table-of-contents__link toc-highlight">手動安裝版本</a></li></ul></li><li><a href="#kubernetes-cluster" class="table-of-contents__link toc-highlight">Kubernetes Cluster</a></li><li><a href="#containerd" class="table-of-contents__link toc-highlight">Containerd</a></li><li><a href="#docker" class="table-of-contents__link toc-highlight">Docker</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">其他資源</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://hwchiu.medium.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">英文部落格<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/technologynoteniu" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook Page(矽谷牛耕田筆記)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/hw_chiu" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/in/hung-wei-chiu-52561494/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Cloud Native Taiwan User Group(CNTUG)</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://cloudnative.tw/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Official Site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/@cloudnativetaiwanusergroup" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.facebook.com/groups/298183320685010" target="_blank" rel="noopener noreferrer" class="footer__link-item">Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://community.cncf.io/cloud-native-taiwan-user-group/" target="_blank" rel="noopener noreferrer" class="footer__link-item">CNCF Page<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://t.me/cntug" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 hwchiu. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.63e3ede8.js"></script>
<script src="/assets/js/main.2d5208eb.js"></script>
</body>
</html>