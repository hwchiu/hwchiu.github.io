"use strict";(self.webpackChunkhwchiu=self.webpackChunkhwchiu||[]).push([[50624],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>g});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),i=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},m=function(e){var t=i(e.components);return r.createElement(l.Provider,{value:t},e.children)},u="mdxType",k={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,m=p(e,["components","mdxType","originalType","parentName"]),u=i(n),c=a,g=u["".concat(l,".").concat(c)]||u[c]||k[c]||o;return n?r.createElement(g,s(s({ref:t},m),{},{components:n})):r.createElement(g,s({ref:t},m))}));function g(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,s=new Array(o);s[0]=c;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p[u]="string"==typeof e?e:a,s[1]=p;for(var i=2;i<o;i++)s[i]=n[i];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},83746:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>k,frontMatter:()=>o,metadata:()=>p,toc:()=>i});var r=n(87462),a=(n(67294),n(3905));const o={title:"Container Storage Interface \u57fa\u672c\u4ecb\u7d39",sidebar_position:17,date:new Date("2019-10-03T06:47:37.000Z"),tags:["Kubernetes","CSI","Storage","iThome"],description:"\u672c\u6587\u958b\u59cb\u53c8\u662f\u5d84\u65b0\u7684\u4e00\u7bc7\uff0c\u958b\u59cb\u63a2\u8a0e\u4e5f\u662f\u975e\u5e38\u91cd\u8981\u7684\u5132\u5b58\u8cc7\u6e90\uff0c\u5132\u5b58\u65b9\u9762\u4e5f\u6709\u76f8\u95dc\u7684\u6a19\u6e96\u518d\u767c\u5c55\uff0c\u5176\u76ee\u7684\u8207 CRI \u4ee5\u53ca CNI \u4e00\u81f4\uff0c\u90fd\u662f\u5e0c\u671b\u900f\u904e\u6a19\u6e96\u5316\u63a5\u53e3\u80fd\u5920\u4f7f\u5f97\u7b2c\u4e09\u65b9\u7684\u89e3\u6c7a\u65b9\u6848\u958b\u767c\u66f4\u52a0\u6d3b\u7d61\u4e14\u6d41\u66a2\uff0c\u672c\u6587\u6703\u958b\u59cb\u4f86\u4ecb\u7d39\u5132\u5b58\u65b9\u9762\u7684\u57fa\u672c\u6982\u5ff5\u4ee5\u53ca\u70ba\u4ec0\u9ebc\u9700\u8981 Container Storage Interface"},s="\u524d\u8a00",p={unversionedId:"techPost/2019/iThome_Challenge/csi",id:"techPost/2019/iThome_Challenge/csi",title:"Container Storage Interface \u57fa\u672c\u4ecb\u7d39",description:"\u672c\u6587\u958b\u59cb\u53c8\u662f\u5d84\u65b0\u7684\u4e00\u7bc7\uff0c\u958b\u59cb\u63a2\u8a0e\u4e5f\u662f\u975e\u5e38\u91cd\u8981\u7684\u5132\u5b58\u8cc7\u6e90\uff0c\u5132\u5b58\u65b9\u9762\u4e5f\u6709\u76f8\u95dc\u7684\u6a19\u6e96\u518d\u767c\u5c55\uff0c\u5176\u76ee\u7684\u8207 CRI \u4ee5\u53ca CNI \u4e00\u81f4\uff0c\u90fd\u662f\u5e0c\u671b\u900f\u904e\u6a19\u6e96\u5316\u63a5\u53e3\u80fd\u5920\u4f7f\u5f97\u7b2c\u4e09\u65b9\u7684\u89e3\u6c7a\u65b9\u6848\u958b\u767c\u66f4\u52a0\u6d3b\u7d61\u4e14\u6d41\u66a2\uff0c\u672c\u6587\u6703\u958b\u59cb\u4f86\u4ecb\u7d39\u5132\u5b58\u65b9\u9762\u7684\u57fa\u672c\u6982\u5ff5\u4ee5\u53ca\u70ba\u4ec0\u9ebc\u9700\u8981 Container Storage Interface",source:"@site/docs/techPost/2019/iThome_Challenge/csi.md",sourceDirName:"techPost/2019/iThome_Challenge",slug:"/techPost/2019/iThome_Challenge/csi",permalink:"/docs/techPost/2019/iThome_Challenge/csi",draft:!1,tags:[{label:"Kubernetes",permalink:"/docs/tags/kubernetes"},{label:"CSI",permalink:"/docs/tags/csi"},{label:"Storage",permalink:"/docs/tags/storage"},{label:"iThome",permalink:"/docs/tags/i-thome"}],version:"current",sidebarPosition:17,frontMatter:{title:"Container Storage Interface \u57fa\u672c\u4ecb\u7d39",sidebar_position:17,date:"2019-10-03T06:47:37.000Z",tags:["Kubernetes","CSI","Storage","iThome"],description:"\u672c\u6587\u958b\u59cb\u53c8\u662f\u5d84\u65b0\u7684\u4e00\u7bc7\uff0c\u958b\u59cb\u63a2\u8a0e\u4e5f\u662f\u975e\u5e38\u91cd\u8981\u7684\u5132\u5b58\u8cc7\u6e90\uff0c\u5132\u5b58\u65b9\u9762\u4e5f\u6709\u76f8\u95dc\u7684\u6a19\u6e96\u518d\u767c\u5c55\uff0c\u5176\u76ee\u7684\u8207 CRI \u4ee5\u53ca CNI \u4e00\u81f4\uff0c\u90fd\u662f\u5e0c\u671b\u900f\u904e\u6a19\u6e96\u5316\u63a5\u53e3\u80fd\u5920\u4f7f\u5f97\u7b2c\u4e09\u65b9\u7684\u89e3\u6c7a\u65b9\u6848\u958b\u767c\u66f4\u52a0\u6d3b\u7d61\u4e14\u6d41\u66a2\uff0c\u672c\u6587\u6703\u958b\u59cb\u4f86\u4ecb\u7d39\u5132\u5b58\u65b9\u9762\u7684\u57fa\u672c\u6982\u5ff5\u4ee5\u53ca\u70ba\u4ec0\u9ebc\u9700\u8981 Container Storage Interface"},sidebar:"techPost",previous:{title:"CNI \u9592\u8ac7",permalink:"/docs/techPost/2019/iThome_Challenge/cni-experience"},next:{title:"Container Storage Interface \u6a19\u6e96\u4ecb\u7d39",permalink:"/docs/techPost/2019/iThome_Challenge/csi-ii"}},l={},i=[{value:"Before Kubernetes",id:"before-kubernetes",level:2},{value:"Kubernetes",id:"kubernetes",level:2},{value:"Why Container Storage Interface",id:"why-container-storage-interface",level:2}],m={toc:i},u="wrapper";function k(e){let{components:t,...n}=e;return(0,a.kt)(u,(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"\u524d\u8a00"},"\u524d\u8a00"),(0,a.kt)("p",null,"\u8b1b\u5b8c\u4e86 ",(0,a.kt)("strong",{parentName:"p"},"Container Rnntime Interface(CRI)")," \u4ee5\u53ca ",(0,a.kt)("strong",{parentName:"p"},"Container Network Interface(CNI)")," \u5169\u5927\u8cc7\u6e90\u5f8c\uff0c\u6211\u5011\u5c07\u4f86\u63a2\u8a0e\u6700\u5f8c\u7684\u4e00\u584a\u62fc\u5716\uff0c\u6240\u8b02\u7684 ",(0,a.kt)("strong",{parentName:"p"},"Container Storage Interface(CSI)"),"\u3002"),(0,a.kt)("p",null,"\u5132\u5b58\u9019\u500b\u9818\u57df\u65bc\u7cfb\u7d71\u61c9\u7528\u4e2d\u4e5f\u662f\u767e\u767e\u60c5\u5883\u767e\u767e\u89e3\uff0c\u8207\u7db2\u8def\u4e00\u6a23\u90fd\u9700\u8981\u6839\u64da\u4e0d\u540c\u7684\u9700\u6c42\u5c0e\u5165\u4e0d\u540c\u7684\u89e3\u6c7a\u65b9\u6848\u3002\n\u6b64\u5916\u5132\u5b58\u9019\u9818\u57df\u5230\u5e95\u8207 ",(0,a.kt)("strong",{parentName:"p"},"kubernetes")," \u5f7c\u6b64\u4e4b\u9593\u7684\u8cac\u4efb\u6b78\u5c6c\u5230\u5e95\u8a72\u600e\u9ebc\u5206\u914d\uff0c\u6211\u89ba\u5f97\u4e5f\u662f\u4e00\u500b\u5f88\u91cd\u8981\u7684\u8b70\u984c\uff0c\u56e0\u70ba\u6700\u8fd1\u5be6\u5728\u770b\u5230\u592a\u591a\u70ba\u4e86 ",(0,a.kt)("strong",{parentName:"p"},"kubernetes")," \u800c ",(0,a.kt)("strong",{parentName:"p"},"kubernetes")," \u7684\u63a8\u6cd5\uff0c\u5b8c\u5168\u6c92\u6709\u8003\u616e\u5230\u8f49\u79fb\u7684\u6210\u672c\u8207\u96e3\u984c\uff0c\u5c31\u5e0c\u671b ",(0,a.kt)("strong",{parentName:"p"},"kuberntes")," \u80fd\u5920\u63a5\u624b\u4e00\u5207\u4e8b\u7269\uff0c\u56e0\u6b64\u63a5\u4e0b\u4f86\u7684\u6587\u7ae0\u6a5f\u6703\u8457\u91cd\u65bc ",(0,a.kt)("strong",{parentName:"p"},"Storage")," \u9019\u4e00\u584a\u7684\u4ecb\u7d39\u3002"),(0,a.kt)("h2",{id:"before-kubernetes"},"Before Kubernetes"),(0,a.kt)("p",null,"\u5404\u4f4d\u5176\u5be6\u53ef\u4ee5\u56de\u60f3\u4e00\u4e0b\u904e\u5f80\u6240\u6709\u7684\u7d93\u9a57\u4e2d\uff0c\u9047\u904e\u5132\u5b58\u4ec0\u9ebc\u6a23\u7684\u554f\u984c\u4ee5\u53ca\u8b70\u984c?"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u5149\u6a94\u6848\u7cfb\u7d71\u672c\u8eab\u5c31\u662f\u4e00\u500b\u6230\u5c40\uff0cBTRFS, Ext4, ZFS, CephFS, GLusterFS\uff0c\u5404\u81ea\u7684\u7279\u8272\u8207\u512a\u52a3\u8a72\u5982\u4f55\u9078\u64c7"),(0,a.kt)("li",{parentName:"ol"},"\u5feb\u7167\u7684\u652f\u63f4\uff0c\u4ee5\u53ca\u5feb\u7167\u5f8c\u5bb9\u91cf\u662f\u5426\u52a0\u500d\uff1f"),(0,a.kt)("li",{parentName:"ol"},"LLVM/RAID/RAID2.0 \u7b49\u76f8\u95dc\u8b70\u984c\u7684\u8a0e\u8ad6\uff0c\u80fd\u5920\u5bb9\u932f\u591a\u5c11\u786c\u789f\uff0c\u80fd\u5920\u591a\u5feb\u4fee\u5fa9?"),(0,a.kt)("li",{parentName:"ol"},"RWO \u8b80\u5beb\u7684\u9650\u5236\uff0c\u53ef\u5426\u540c\u6642\u591a\u91cd\u8b80\u5beb\u6216\u662f\u53ea\u80fd\u55ae\u4e00\u8655\u7406?"),(0,a.kt)("li",{parentName:"ol"},"\u4ecb\u9762\u7684\u9078\u64c7\uff0c\u662f\u66f4\u5e95\u5c64\u7684 Block Device \u9084\u662f\u4e0a\u5c64\u5df2\u7d93\u5305\u88dd\u53ef\u4ee5\u4f7f\u7528\u7684\u6a94\u6848\u7cfb\u7d71\u8def\u5f91?"),(0,a.kt)("li",{parentName:"ol"},"\u7570\u5730\u5099\u63f4? \u672c\u5730\u5099\u63f4?"),(0,a.kt)("li",{parentName:"ol"},"\u5132\u5b58\u670d\u52d9\u672c\u8eab\u6709\u6c92\u6709HA\u7684\u6a5f\u5236\uff0c\u6709\u6c92\u6709SLA\u7684\u4fdd\u969c?"),(0,a.kt)("li",{parentName:"ol"},"...\u7b49")),(0,a.kt)("p",null,"\u904e\u5f80\u65b9\u9762\u5c31\u6709\u6d0b\u6d0b\u7051\u7051\u7684\u8b70\u984c\u8981\u8655\u7406\uff0c\u5f88\u591a\u60c5\u6cc1\u751a\u81f3\u90fd\u662f\u5c0b\u627e\u7368\u7acb\u7684\u5132\u5b58\u5ee0\u5546\u9032\u4f86\u8207\u73fe\u5b58\u7cfb\u7d71\u6574\u5408\uff0c\u63d0\u4f9b\u4e00\u500b\u5132\u5b58\u89e3\u6c7a\u65b9\u6848\uff0c\u5c07\u9019\u4e9b\u554f\u984c\u90fd\u8cac\u4efb\u6b78\u5c6c\u4f86\u8655\u7406\uff0c\u8b93\u5132\u5b58\u4f3a\u670d\u5668\u672c\u8eab\u4f86\u8ca0\u8cac\u9019\u4e9b\u8b70\u984c\uff0c\u800c\u81ea\u5df1\u7684\u670d\u52d9\u5247\u5c08\u6ce8\u65bc\u8655\u7406\u7368\u7279\u7684\u5546\u696d\u908f\u8f2f\u3002"),(0,a.kt)("p",null,"\u5982\u679c\u904e\u5f80\u64cd\u4f5c\u8207\u7dad\u904b\u4e0a\u6709\u9019\u4e9b\u7d93\u9a57\u8207\u6982\u5ff5\uff0c\u4eca\u5929\u8981\u5c07\u670d\u52d9\u5168\u9762\u5c0e\u5411 Kubernetes\uff0c\u4e5f\u4e00\u5b9a\u8981\u6709\u4e00\u6a23\u7684\u6982\u5ff5\u4f86\u8655\u7406\uff0c\u56e0\u70ba kubernetes \u672c\u8eab\u6c92\u6709\u4efb\u4f55\u9032\u968e\u7684\u5132\u5b58\u529f\u80fd\uff0c\u4e0a\u9762\u63d0\u5230\u7684\u6982\u5ff5\u8207\u6280\u8853\u5168\u90e8\u90fd\u6c92\u6709\uff0c\u4e00\u5207\u90fd\u662f\u8981\u4ef0\u8cf4\u984d\u5916\u7684\u5132\u5b58\u8a2d\u5099\u8207\u6280\u8853\u4f86\u63d0\u4f9b\u9019\u4e9b\u529f\u80fd\uff0c\u6240\u4ee5\u4e0d\u8981\u62b1\u6301\u592a\u5927\u7684\u5922\u60f3 kubernetes \u80fd\u5920\u63d0\u4f9b\u4e00\u6b65\u5230\u4f4d\u89e3\u6c7a\u6240\u6709\u4e8b\u60c5\u3002"),(0,a.kt)("h2",{id:"kubernetes"},"Kubernetes"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"kubernetes")," \u91dd\u5c0d\u5132\u5b58\u90e8\u5206\uff0c\u4f7f\u7528\u8005\u53ef\u4ee5\u4f7f\u7528\u7684\u65b9\u5f0f\u6709\u5f88\u591a\u7a2e\uff0c\u96d6\u7136\u770b\u4f3c\u591a\u7a2e\uff0c\u5176\u5be6\u80cc\u5f8c\u7684\u908f\u8f2f\u8108\u7d61\u662f\u4e00\u81f4\u7684\u3002"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u5ba3\u544a\uff0f\u8acb\u6c42 \u5132\u5b58\u7a7a\u9593"),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Pod")," \u53bb\u8acb\u6c42\u4f7f\u7528\u4ee5\u5275\u7acb\u7684\u5132\u5b58\u7a7a\u9593\u4f86\u4f7f\u7528"),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("strong",{parentName:"li"},"Container")," \u88e1\u9762\u63cf\u8ff0\u5982\u4f55\u4f7f\u7528 ",(0,a.kt)("strong",{parentName:"li"},"Pod")," \u8acb\u6c42\u4f86\u7684\u5132\u5b58\u7a7a\u9593")),(0,a.kt)("p",null,"\u6700\u7c21\u55ae\u7684\u4f7f\u7528\u65b9\u6cd5\u5c31\u662f\u5c07\u4e0a\u8ff0\u6240\u6709\u908f\u8f2f\u5168\u90e8\u90fd\u63cf\u8ff0\u5728\u540c\u4e00\u500b ",(0,a.kt)("strong",{parentName:"p"},"Pod")," \u7684\u8cc7\u6e90\u4e2d\uff0c\u7d71\u4e00\u7ba1\u7406\u7d71\u4e00\u7dad\u8b77\uff0c\u4f46\u662f\u9019\u7a2e\u65b9\u6cd5\u4e00\u65e6\u8a72\u5132\u5b58\u7a7a\u9593\u662f\u9700\u8981\u8de8 ",(0,a.kt)("strong",{parentName:"p"},"Pod")," \u4f7f\u7528\u6642\u5c31\u6703\u5e36\u4f86\u7dad\u8b77\u4e0d\u898b\u3002"),(0,a.kt)("p",null,"\u6240\u4ee5\u53ef\u4ee5\u900f\u904e ",(0,a.kt)("strong",{parentName:"p"},"PersistemVolume")," \u4ee5\u53ca ",(0,a.kt)("strong",{parentName:"p"},"PersistemVolumeClaim")," \u7b49\u4e0d\u540c\u5c64\u7d1a\u7684\u5132\u5b58\u7a7a\u9593\u6982\u5ff5\u4f86\u7dad\u8b77\uff0c\u4f5c\u70ba\u6574\u500b kubernetes cluster \u5167\u90e8\u8cc7\u6e90\u7684\u8a71\u5c0d\u65bc\u5171\u7528\uff0c\u7ba1\u7406\u65b9\u9762\u4e5f\u90fd\u6709\u76f8\u7576\u597d\u7684\u63a7\u7ba1\u6027\u3002"),(0,a.kt)("p",null,"\u7136\u800c\u4e0a\u8ff0\u7684\u8cc7\u6e90\u8abf\u5ea6\u6709\u6642\u5019\u53c8\u592a\u904e\u65bc\u975c\u614b\uff0c\u7f3a\u4e4f\u5f48\u6027\uff0c\u56e0\u6b64\u5f8c\u4f86\u53c8\u884d\u751f\u51fa ",(0,a.kt)("strong",{parentName:"p"},"StorageClass")," \u9019\u7a2e\u52d5\u614b\u8acb\u6c42\u7684\u8cc7\u6e90\uff0c\u5c0d\u65bc\u4f7f\u7528\u8005\u4f86\u8aaa\u53ef\u4ee5\u6e1b\u5c11\u66f4\u591a\u8a2d\u5b9a\uff0c\u6574\u9ad4\u4f7f\u7528\u8d77\u4f86\u6703\u66f4\u52a0\u9806\u624b\u3002"),(0,a.kt)("p",null,"\u95dc\u65bc\u4e0a\u8ff0\u4e09\u7a2e\u8cc7\u6e90\u7684\u5f7c\u6b64\u95dc\u4fc2\uff0c\u6982\u5ff5\uff0c\u53ef\u4ee5\u53c3\u8003\u9019\u7bc7\u6587\u7ae0 ",(0,a.kt)("a",{parentName:"p",href:"https://www.hwchiu.com/kubernetes-storage-i.html"},"kubernetes storage")),(0,a.kt)("p",null,"\u9664\u4e86\u9019\u4e09\u500b\u985e\u5225\u8cc7\u6e90\u5916\uff0c\u5176\u5be6\u9084\u6709\u5169\u500b\u5e38\u7528\u7684\u8cc7\u6e90\u4e5f\u8207\u5132\u5b58\u606f\u606f\u76f8\u95dc\uff0c",(0,a.kt)("strong",{parentName:"p"},"ConfigMap")," \u4ee5\u53ca ",(0,a.kt)("strong",{parentName:"p"},"Secret"),"\uff0c \u9019\u5169\u500b\u8cc7\u6e90\u8a2d\u5b9a\u7684\u4ecb\u9762\u8207\u4e0a\u8ff0\u63d0\u5230\u7684\u4e9b\u8a31\u4e0d\u540c\uff0c\u4f46\u662f\u6700\u5f8c\u90fd\u6703\u4ee5\u6a94\u6848\u6216\u5176\u4ed6\u7684\u5f62\u5f0f\u51fa\u73fe\u65bc ",(0,a.kt)("strong",{parentName:"p"},"Container")," \u4f9b\u61c9\u7528\u7a0b\u5f0f\u4f7f\u7528\u3002\n\u53ea\u8981\u80fd\u5920\u8b93 ",(0,a.kt)("strong",{parentName:"p"},"Container")," \u6709\u8fa6\u6cd5\u5b58\u53d6\u5230\u5916\u90e8\u7684\u5b58\u53d6\u7a7a\u9593\uff0c\u9019\u904e\u7a0b\u90fd\u6703\u727d\u626f\u5230 ",(0,a.kt)("strong",{parentName:"p"},"Container")," \u7684\u5275\u9020\uff0c\u751a\u81f3\u662f ",(0,a.kt)("strong",{parentName:"p"},"Linux Mount Namespace")," \u7684\u6d89\u5165\u8207\u8655\u7406\u3002"),(0,a.kt)("p",null,"\u5c0d\u65bc\u5927\u90e8\u5206\u7684\u4f7f\u7528\u8005\u4f86\u8aaa\uff0c ",(0,a.kt)("strong",{parentName:"p"},"Storage")," \u7684\u4ecb\u9762(\u4e0a\u8ff0\u6982\u5ff5)\u7528\u8d77\u4f86\u90fd\u4e0d\u6703\u6709\u592a\u591a\u7684\u554f\u984c\uff0c\u9078\u5b9a\u597d\u81ea\u5df1\u8981\u4f7f\u7528\u7684\u5132\u5b58\u5f8c\u7aef\uff0c\u53c3\u8003\u6587\u4ef6\u5982\u4f55\u8a2d\u5b9a\uff0c\u63a5\u4e0b\u4f86\u5230 ",(0,a.kt)("strong",{parentName:"p"},"Pod")," \u5c64\u7d1a\u6642\u4f7f\u7528\u5c31\u76f8\u5c0d\u7c21\u55ae\uff0c\u4e0d\u6703\u6709\u592a\u591a\u8a2d\u5b9a\u4e0a\u7684\u56f0\u64fe\u3002 \u90a3\u5230\u5e95 ",(0,a.kt)("strong",{parentName:"p"},"Container Storage Interface")," \u65bc\u6574\u500b\u904e\u7a0b\u4e2d\u662f\u626e\u6f14\u4ec0\u9ebc\u89d2\u8272? \u9019\u500b\u554f\u984c\u5c31\u662f\u63a5\u4e0b\u4f86\u7684\u5e7e\u7bc7\u6587\u7ae0\u6703\u63a2\u8a0e\u7684\uff0c\u4e26\u4e14\u8aaa\u660e\u70ba\u4ec0\u9ebc\u8981\u5f15\u5165 ",(0,a.kt)("strong",{parentName:"p"},"CSI")," \u4ee5\u53ca\u5176\u53ef\u4ee5\u5e36\u4f86\u4ec0\u9ebc\u6a23\u7684\u5e6b\u52a9\u3002"),(0,a.kt)("h2",{id:"why-container-storage-interface"},"Why Container Storage Interface"),(0,a.kt)("p",null,"\u5982\u540c\u524d\u8ff0\u63a2\u8a0e ",(0,a.kt)("strong",{parentName:"p"},"CRI")," \u4ee5\u53ca ",(0,a.kt)("strong",{parentName:"p"},"CNI")," \u6642\u90fd\u6709\u8a0e\u8ad6\u904e\u70ba\u4ec0\u9ebc\u8981\u4f7f\u7528 ",(0,a.kt)("strong",{parentName:"p"},"Interface")," \u7684\u7406\u7531\uff0c\u85c9\u7531\u5c07\u6a21\u7d44\u8207\u4e3b\u7a0b\u5f0f\u62bd\u96e2\uff0c\u8b93\u5404\u81ea\u7684\u5c08\u6848\u90fd\u6709\u81ea\u5df1\u7684\u958b\u767c\u9031\u671f\uff0c\u5f7c\u6b64\u4e0d\u6703\u4e92\u76f8\u88ab\u5f71\u97ff\u800c\u5c0e\u81f4\u958b\u767c\u6216\u4f7f\u7528\u53d7\u963b\u3002"),(0,a.kt)("p",null,"\u9019\u4e00\u7bc7\u5b98\u65b9\u90e8\u843d\u683c\u7684\u6587\u7ae0 ",(0,a.kt)("a",{parentName:"p",href:"https://kubernetes.io/blog/2019/01/15/container-storage-interface-ga/"},"Container Storage Interface (CSI) for Kubernetes GA")," \u6709\u7279\u5225\u63cf\u8ff0\u5230\u70ba\u4ec0\u9ebc\u9700\u8981 ",(0,a.kt)("strong",{parentName:"p"},"Container Storage Interface"),"\u3002"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Although prior to CSI Kubernetes provided a powerful volume plugin system, it was challenging to add support for new volume plugins to Kubernetes: volume plugins were \u201cin-tree\u201d meaning their code was part of the core Kubernetes code and shipped with the core Kubernetes binaries\u2014vendors wanting to add support for their storage system to Kubernetes (or even fix a bug in an existing volume plugin) were forced to align with the Kubernetes release process. In addition, third-party storage code caused reliability and security issues in core Kubernetes binaries and the code was often difficult (and in some cases impossible) for Kubernetes\nmaintainers to test and maintain.")),(0,a.kt)("p",null,"\u9577\u671f\u4ee5\u4f86\u6240\u6709\u5132\u5b58\u7684\u89e3\u6c7a\u65b9\u6848\u7684\u6574\u5408\u7aef\u90fd\u662f\u76f4\u63a5\u5be6\u4f5c\u65bc ",(0,a.kt)("strong",{parentName:"p"},"Kubernetes")," \u7684\u7a0b\u5f0f\u78bc\u5167\uff0c\u4e5f\u662f\u6240\u8b02\u7684 ",(0,a.kt)("strong",{parentName:"p"},"in-tree")," \u6240\u63cf\u8ff0\u7684\u6982\u5ff5\uff0c\u9019\u5c0e\u81f4\u5c0d\u65bc\u9019\u4e9b\u5132\u5b58\u61c9\u7528\u670d\u52d9\u7684\u63d0\u4f9b\u8005\u5f88\u96e3\u53ca\u6642\u7684\u589e\u52a0\u4fee\u5fa9\u4efb\u4f55\u554f\u984c\uff0c\u56e0\u70ba\u5168\u90e8\u7684\u529f\u80fd\u90fd\u8ddf ",(0,a.kt)("strong",{parentName:"p"},"kubernetes")," \u672c\u8eab\u7d81\u518d\u4e00\u8d77\uff0c\u82e5 ",(0,a.kt)("strong",{parentName:"p"},"kubernetes")," \u672c\u8eab\u6c92\u6709\u66f4\u65b0\uff0c\u5247\u4f7f\u7528\u8005\u4e5f\u90fd\u4eab\u53d7\u4e0d\u5230\u4fee\u5fa9\u6216\u662f\u65b0\u529f\u80fd\u3002\n\u66f4\u91cd\u8981\u7684\u662f\u9019\u4e9b\u5132\u5b58\u76f8\u95dc\u7a0b\u5f0f\u78bc\u672c\u8eab\u7684\u5b89\u5168\u6027\u7a0b\u5ea6\u4ee5\u53ca\u7a69\u5b9a\u6027\u90fd\u6703\u8b8a\u6210\u984d\u5916\u7684\u96b1\u6182\uff0c\u662f\u5426\u6703\u5c0d ",(0,a.kt)("strong",{parentName:"p"},"kubernetes")," \u672c\u8eab\u5e36\u4f86\u5404\u7a2e\u8ca0\u9762\u7684\u90fd\u662f\u4e0d\u80fd\u638c\u63e1\u7684\uff0c\u540c\u6642\u9019\u4e9b\u7a0b\u5f0f\u78bc\u7684\u7dad\u8b77\u5c0d\u65bc ",(0,a.kt)("strong",{parentName:"p"},"kubernetes")," \u7dad\u8b77\u8005\u4f86\u8aaa\u4e5f\u662f\u4e0d\u597d\u7dad\u8b77\u53ca\u638c\u63e1\u7684\u3002"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"CSI was developed as a standard for exposing arbitrary block and file storage storage systems to containerized workloads on Container Orchestration Systems (COs) like Kubernetes. With the adoption of the Container Storage Interface, the Kubernetes volume layer becomes truly extensible. Using CSI, third-party storage providers can write and deploy plugins exposing new storage systems in Kubernetes without ever having to touch the core Kubernetes code. This gives Kubernetes users more options for storage and\nmakes the system more secure and reliable.")),(0,a.kt)("p",null,"\u70ba\u4e86\u89e3\u6c7a\u9019\u500b\u554f\u984c\u65bc\u662f\u63d0\u51fa\u4e86 ",(0,a.kt)("strong",{parentName:"p"},"Container Storage Interface")," \u7684\u6982\u5ff5\uff0c\u5e0c\u671b\u80fd\u5920\u5c07\u5132\u5b58\u65b9\u9762\u7684\u7a0b\u5f0f\u78bc\u90fd\u642c\u51fa\u53bb ",(0,a.kt)("strong",{parentName:"p"},"kubernetes")," \u672c\u8eab\uff0c\u5982\u540c ",(0,a.kt)("strong",{parentName:"p"},"CRI/CNI")," \u4e00\u6a23\uff0c\u80fd\u5920\u8b93 ",(0,a.kt)("strong",{parentName:"p"},"kubernetes")," \u5c08\u5fc3\u7dad\u8b77\u8207\u4ecb\u9762\u4f9b\u901a\u7684\u6574\u5408\uff0c\u800c\u5176\u9918\u7684\u5132\u5b58\u89e3\u6c7a\u65b9\u6848\u63d0\u4f9b\u5546\u5c08\u6ce8\u65bc ",(0,a.kt)("strong",{parentName:"p"},"CSI")," \u4ecb\u9762\u7684\u958b\u767c\uff0c\u6700\u5f8c\u5c31\u53ef\u4ee5\u900f\u904e\u53c3\u6578\u7b49\u65b9\u5f0f\u4f86\u9593\u63a5\u4f7f\u7528\u8207\u6574\u5408\u3002"),(0,a.kt)("p",null,"\u90a3\u8aaa\u4e86\u9019\u9ebc\u591a\uff0c\u4eca\u5929 ",(0,a.kt)("strong",{parentName:"p"},"CSI")," \u5168\u9762\u5f15\u9032\u5f8c\uff0c\u5c0d\u65bc\u4f7f\u7528\u8005\u5230\u5e95\u6703\u6709\u4ec0\u9ebc\u5dee\u7570? \u6709\u4ec0\u9ebc\u90e8\u5206\u9700\u8981\u4fee\u6539\u4ee5\u7b26\u5408\u65b0\u7684\u67b6\u69cb?"),(0,a.kt)("p",null,"\u6211\u5011\u5148\u4f86\u770b\u4e00\u4e0b\u6c92\u6709\u4f7f\u7528 ",(0,a.kt)("strong",{parentName:"p"},"CSI")," \u7684\u67b6\u69cb\uff0c\u6703\u600e\u9ebc\u4f7f\u7528 ",(0,a.kt)("strong",{parentName:"p"},"Network File System (NFS)"),"\u3002"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml="},'kind: Pod\napiVersion: v1\nmetadata:\n  name: nfs-in-a-pod\nspec:\n  containers:\n    - name: app\n      image: alpine\n      volumeMounts:\n        - name: nfs-volume\n          mountPath: /var/nfs # Please change the destination you like the share to be mounted too\n      command: ["/bin/sh"]\n      args: ["-c", "sleep 500000"]\n  volumes:\n    - name: nfs-volume\n      nfs:\n        server: nfs.example.com # Please change this to your NFS server\n        path: /share1 # Please change this to the relevant share\n')),(0,a.kt)("p",null,"\u5f9e\u4e0a\u8ff0\u7684 ",(0,a.kt)("strong",{parentName:"p"},"yaml")," \u4e2d\u53ef\u4ee5\u770b\u5230\u76f4\u63a5\u63cf\u8ff0\u4f7f\u7528 ",(0,a.kt)("strong",{parentName:"p"},"NFS")," \u7684\u7d50\u69cb\uff0c\u4e26\u4e14\u56e0\u70ba ",(0,a.kt)("strong",{parentName:"p"},"NFS")," \u9700\u8981\u7684\u53c3\u6578\u6709\u5169\u500b\uff0c\u56e0\u6b64\u4e5f\u9700\u8981\u65bc ",(0,a.kt)("strong",{parentName:"p"},"yaml")," \u53bb\u63cf\u8ff0\u9019\u5169\u500b\u53c3\u6578\u3002"),(0,a.kt)("p",null,"\u9019\u500b\u7528\u6cd5\u975e\u5e38\u7684\u7d81\u6b7b\uff0c\u5be6\u969b\u4e0a\u9019\u4e9b ",(0,a.kt)("strong",{parentName:"p"},"yaml")," \u7684\u89e3\u8b80\u90fd\u662f\u4f9d\u8cf4 ",(0,a.kt)("strong",{parentName:"p"},"kubernetes")," \u672c\u8eab\u53bb\u8655\u7406\uff0c\u6240\u4ee5\u5176\u672c\u8eab\u95dc\u65bc ",(0,a.kt)("strong",{parentName:"p"},"volume")," \u7684\u8cc7\u6599\u7d50\u69cb\u4e2d\u5c31\u5305\u542b\u4e86 ",(0,a.kt)("strong",{parentName:"p"},"NFS")," \u7684\u6b04\u4f4d\uff0c\u4ee5\u53ca\u76f8\u95dc\u7684\u53c3\u6578\uff0c\u9019\u7a2e\u60c5\u6cc1\u5c0d\u65bc ",(0,a.kt)("strong",{parentName:"p"},"NFS")," \u4f86\u8aaa\u6709\u4efb\u4f55\u4fee\u6539\u589e\u6e1b\uff0c\u90fd\u5fc5\u9808\u8981\u4fee\u6539 ",(0,a.kt)("strong",{parentName:"p"},"kubernetes")," \u539f\u59cb\u78bc\uff0c\u4e5f\u662f\u6240\u8b02\u7684 ",(0,a.kt)("strong",{parentName:"p"},"in-tree")," \u67b6\u69cb\u9020\u6210\u7684\u56f0\u5883\u3002"),(0,a.kt)("p",null,"\u5982\u679c\u6539\u5584\u6210 ",(0,a.kt)("strong",{parentName:"p"},"CSI")," \u4e4b\u5f8c\uff0c\u6574\u500b\u61c9\u7528\u6703\u8b8a\u6210\u600e\u9ebc\u6a23\uff1f"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml="},'apiVersion: v1\nkind: PersistentVolume\nmetadata:\n  name: data-nfsplugin\n  labels:\n    name: data-nfsplugin\nspec:\n  accessModes:\n  - ReadWriteMany\n  capacity:\n    storage: 100Gi\n  csi:\n    driver: csi-nfsplugin\n    volumeHandle: data-id\n    volumeAttributes:\n      server: 127.0.0.1\n      share: /export\n---\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: data-nfsplugin\nspec:\n  accessModes:\n  - ReadWriteMany\n  resources:\n    requests:\n      storage: 100Gi\n  selector:\n    matchExpressions:\n    - key: name\n      operator: In\n      values: ["data-nfsplugin"]\n---\napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx\nspec:\n  containers:\n  - image: maersk/nginx\n    imagePullPolicy: Always\n    name: nginx\n    ports:\n    - containerPort: 80\n      protocol: TCP\n    volumeMounts:\n      - mountPath: /var/www\n        name: data-nfsplugin\n  volumes:\n  - name: data-nfsplugin\n    persistentVolumeClaim:\n      claimName: data-nfsplugin\n')),(0,a.kt)("p",null,"\u53ef\u4ee5\u770b\u5230\u9019\u500b\u7bc4\u4f8b\u4e2d\uff0c\u4e0d\u518d\u4f7f\u7528 ",(0,a.kt)("strong",{parentName:"p"},"NFS")," \u7684\u95dc\u9375\u5b57\uff0c\u800c\u662f\u63a1\u7528\u4e86 ",(0,a.kt)("strong",{parentName:"p"},"CSI")," \u9019\u500b\u95dc\u9375\u5b57\uff0c\u4e26\u4e14\u65bc\u5176\u4e2d\u63cf\u8ff0\u4e86\u5e7e\u500b\u8cc7\u8a0a"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"driver:\n\u985e\u4f3c ",(0,a.kt)("strong",{parentName:"li"},"CNI")," \u8a2d\u5b9a\u6a94\u6848\u4e2d\u7684 ",(0,a.kt)("strong",{parentName:"li"},"type"),"\uff0c\u63cf\u8ff0\u8981\u7528\u54ea\u500b\u5c0d\u61c9\u7684 driver \u4f86\u8655\u7406\u9019\u500b\u5132\u5b58\u9700\u6c42"),(0,a.kt)("li",{parentName:"ol"},"volumeHandle:\n\u4e00\u7d44\u91cd\u8907\u4f7f\u7528\u7684 ID\uff0c\u4e4b\u5f8c\u6703\u518d\u4ecb\u7d39"),(0,a.kt)("li",{parentName:"ol"},"volumeAttributes:",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"server: 127.0.0.1"),(0,a.kt)("li",{parentName:"ul"},"share: /export\n\u5ba2\u88fd\u5316\u7684\u53c3\u6578\uff0c\u6839\u64da\u4e0d\u540c\u7684 Driver \u50b3\u5165\u4e0d\u540c\u7684\u53c3\u6578\u3002")))),(0,a.kt)("p",null,"\u6839\u64da\u76ee\u524d",(0,a.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/concepts/storage/volumes/#csi"},"\u5b98\u65b9\u6587\u4ef6")," \u88e1\u9762\u7684\u63cf\u8ff0\uff0c\u73fe\u5728 ",(0,a.kt)("strong",{parentName:"p"},"CSI")," \u4f7f\u7528\u7684\u53c3\u6578\u5982\u6232\u311a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"driver"),(0,a.kt)("li",{parentName:"ul"},"volumeHandle"),(0,a.kt)("li",{parentName:"ul"},"readOnly"),(0,a.kt)("li",{parentName:"ul"},"fsType"),(0,a.kt)("li",{parentName:"ul"},"volumeAttributes"),(0,a.kt)("li",{parentName:"ul"},"controllerPublishSecretRef"),(0,a.kt)("li",{parentName:"ul"},"nodeStageSecretRef"),(0,a.kt)("li",{parentName:"ul"},"nodePublishSecretRef")),(0,a.kt)("p",null,"\u9019\u908a\u7684\u53c3\u6578\u8207 ",(0,a.kt)("strong",{parentName:"p"},"CSI")," \u7684\u6a19\u6e96\u4ee5\u53ca\u904b\u4f5c\u6d41\u7a0b\u6709\u95dc\uff0c\u56e0\u6b64\u7b49\u5230\u4ecb\u7d39 ",(0,a.kt)("strong",{parentName:"p"},"CSI")," \u6a19\u6e96\u5f8c\u6703\u518d\u4f86\u91cd\u65b0\u770b\u9019\u4e9b\u53c3\u6578\u3002"),(0,a.kt)("p",null,"\u5957\u7528 ",(0,a.kt)("strong",{parentName:"p"},"CSI")," \u7684\u67b6\u69cb\u5f8c\uff0c\u6700\u5927\u7684\u5dee\u7570\u4f7f\u7528\u5c31\u662f\u4e4b\u5f8c\u6240\u6709\u7684\u5132\u5b58\u9023\u63a5\u90fd\u8981\u4f7f\u7528 ",(0,a.kt)("strong",{parentName:"p"},"CSI")," \u9019\u500b\u9078\u9805\u4f86\u63cf\u8ff0\uff0c\u800c\u975e\u4ee5\u524d\u76f4\u63a5\u53bb\u63cf\u8ff0\u76ee\u6a19\u7684\u5132\u5b58\u89e3\u6c7a\u65b9\u6848\u3002"),(0,a.kt)("h1",{id:"summary"},"Summary"),(0,a.kt)("p",null,"\u672c\u6587\u8a0e\u8ad6\u4e86 Kubernetes \u8207\u5132\u5b58\u7684\u4e00\u4e9b\u57fa\u672c\u95dc\u4fc2\uff0c\u4e26\u4e14\u5e36\u51fa\u4e86 ",(0,a.kt)("strong",{parentName:"p"},"Container Storage Interface")," \u8207 ",(0,a.kt)("strong",{parentName:"p"},"Kubernetes")," \u7684\u4f7f\u7528\u65b9\u5f0f\u3002"),(0,a.kt)("p",null,"\u63a5\u4e0b\u4f86\u6703\u958b\u59cb\u63a2\u8a0e ",(0,a.kt)("strong",{parentName:"p"},"CSI")," \u76f8\u95dc\u7684\u67b6\u69cb\uff0c\u4e26\u4e14\u4ee5\u4e00\u4e9b\u5df2\u7d93\u5be6\u73fe\u7684 ",(0,a.kt)("strong",{parentName:"p"},"CSI")," \u89e3\u6c7a\u65b9\u6848\u4f86\u8a0e\u8ad6\u8a72\u600e\u9ebc\u4f7f\u7528\u3002"),(0,a.kt)("h1",{id:"\u53c3\u8003"},"\u53c3\u8003"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://kubernetes.io/blog/2019/01/15/container-storage-interface-ga/"},"https://kubernetes.io/blog/2019/01/15/container-storage-interface-ga/")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/kubernetes-csi/drivers/blob/master/pkg/nfs/examples/kubernetes/nginx.yaml"},"https://github.com/kubernetes-csi/drivers/blob/master/pkg/nfs/examples/kubernetes/nginx.yaml")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.docker.com/ee/ucp/kubernetes/storage/use-nfs-volumes/"},"https://docs.docker.com/ee/ucp/kubernetes/storage/use-nfs-volumes/"))))}k.isMDXComponent=!0}}]);