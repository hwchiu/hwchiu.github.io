"use strict";(self.webpackChunkhwchiu=self.webpackChunkhwchiu||[]).push([[33866],{3905:(t,e,r)=>{r.d(e,{Zo:()=>m,kt:()=>u});var n=r(67294);function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?p(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e){if(null==t)return{};var r,n,a=function(t,e){if(null==t)return{};var r,n,a={},p=Object.keys(t);for(n=0;n<p.length;n++)r=p[n],e.indexOf(r)>=0||(a[r]=t[r]);return a}(t,e);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(t);for(n=0;n<p.length;n++)r=p[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}var l=n.createContext({}),i=function(t){var e=n.useContext(l),r=e;return t&&(r="function"==typeof t?t(e):o(o({},e),t)),r},m=function(t){var e=i(t.components);return n.createElement(l.Provider,{value:e},t.children)},k="mdxType",c={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},g=n.forwardRef((function(t,e){var r=t.components,a=t.mdxType,p=t.originalType,l=t.parentName,m=s(t,["components","mdxType","originalType","parentName"]),k=i(r),g=a,u=k["".concat(l,".").concat(g)]||k[g]||c[g]||p;return r?n.createElement(u,o(o({ref:e},m),{},{components:r})):n.createElement(u,o({ref:e},m))}));function u(t,e){var r=arguments,a=e&&e.mdxType;if("string"==typeof t||a){var p=r.length,o=new Array(p);o[0]=g;var s={};for(var l in e)hasOwnProperty.call(e,l)&&(s[l]=e[l]);s.originalType=t,s[k]="string"==typeof t?t:a,o[1]=s;for(var i=2;i<p;i++)o[i]=r[i];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}g.displayName="MDXCreateElement"},61471:(t,e,r)=>{r.r(e),r.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>c,frontMatter:()=>p,metadata:()=>s,toc:()=>i});var n=r(87462),a=(r(67294),r(3905));const p={title:"RDMA Introduction (\u4e00)",tags:["RDMA","Ceph","DRBD","Network","Linux"],date:new Date("2017-07-12T03:56:02.000Z"),description:"\u63a2\u8a0e\u4f55\u8b02 RDMA"},o=void 0,s={unversionedId:"techPost/2017/rdma-introduction-i",id:"techPost/2017/rdma-introduction-i",title:"RDMA Introduction (\u4e00)",description:"\u63a2\u8a0e\u4f55\u8b02 RDMA",source:"@site/docs/techPost/2017/rdma-introduction-i.md",sourceDirName:"techPost/2017",slug:"/techPost/2017/rdma-introduction-i",permalink:"/docs/techPost/2017/rdma-introduction-i",draft:!1,tags:[{label:"RDMA",permalink:"/docs/tags/rdma"},{label:"Ceph",permalink:"/docs/tags/ceph"},{label:"DRBD",permalink:"/docs/tags/drbd"},{label:"Network",permalink:"/docs/tags/network"},{label:"Linux",permalink:"/docs/tags/linux"}],version:"current",frontMatter:{title:"RDMA Introduction (\u4e00)",tags:["RDMA","Ceph","DRBD","Network","Linux"],date:"2017-07-12T03:56:02.000Z",description:"\u63a2\u8a0e\u4f55\u8b02 RDMA"},sidebar:"techPost",previous:{title:"[\u8ad6\u6587\u5c0e\u8b80] Re-architecting datacenter networks and stacks for low latency and high performance",permalink:"/docs/techPost/2017/paper-redesign-data-center"},next:{title:"\u624b\u628a\u624b\u6253\u9020\u4eff mininet \u7db2\u8def",permalink:"/docs/techPost/2017/setup-mininet-like-environment"}},l={},i=[{value:"Introduction RDMA",id:"introduction-rdma",level:2},{value:"Advantages",id:"advantages",level:2},{value:"Zero-Copy",id:"zero-copy",level:3},{value:"Kernel bypass",id:"kernel-bypass",level:3},{value:"No CPU involvement",id:"no-cpu-involvement",level:3},{value:"Message based transactions",id:"message-based-transactions",level:3},{value:"Scatter/Gather entries support",id:"scattergather-entries-support",level:3},{value:"Architecture",id:"architecture",level:2},{value:"Architecture",id:"architecture-1",level:3},{value:"BSD Socket",id:"bsd-socket",level:4},{value:"RDMA Side",id:"rdma-side",level:4},{value:"Protocol",id:"protocol",level:4},{value:"Use-Case",id:"use-case",level:2},{value:"Ceph",id:"ceph",level:3},{value:"DRBD",id:"drbd",level:3},{value:"Summary",id:"summary",level:2},{value:"Reference",id:"reference",level:2}],m={toc:i},k="wrapper";function c(t){let{components:e,...r}=t;return(0,a.kt)(k,(0,n.Z)({},m,r,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"\u6709\u9451\u65bc\u4e4b\u524d\u6709\u8aa4\u6253\u8aa4\u649e\u4e0d\u5c0f\u5fc3\u770b\u5b8c ",(0,a.kt)("strong",{parentName:"p"},"ceph")," \u6574\u500b\u5e95\u5c64 ",(0,a.kt)("strong",{parentName:"p"},"networking")," \u5be6\u4f5c\u7684\u7a0b\u5f0f\u78bc\uff0c\u5c31\u9806\u4fbf\u5b78\u7fd2\u4e86\u4e00\u4e0b ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u9019\u500b\u6982\u5ff5\uff0c\u56e0\u6b64\u5728\u9019\u908a\u5206\u4eab\u6211\u6240\u5b78\u7fd2\u5230\u95dc\u65bc ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u7684\u8a8d\u77e5\u3002\n\u9019\u7cfb\u5217\u6587\u7ae0\u4e3b\u8981\u6703\u5206\u6210\u5169\u7bc7\u4f86\u8b1b\u8ff0\uff0c\u7b2c\u4e00\u7bc7\u6bd4\u8f03\u504f\u5411\u79d1\u666e\u7684\u65b9\u5f0f\u4f86\u4ecb\u7d39 RDMA\uff0c\u800c\u7b2c\u4e8c\u7bc7\u5247\u662f\u6703\u6bd4\u8f03\u504f\u5411\u7a0b\u5f0f\u8a2d\u8a08\u5e2b\u7684\u89d2\u5ea6\uff0c\u77ad\u89e3 ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u8207\u50b3\u7d71\u7684 ",(0,a.kt)("strong",{parentName:"p"},"BSD Socket API")," \u7684\u5dee\u7570\u3002"),(0,a.kt)("h2",{id:"introduction-rdma"},"Introduction RDMA"),(0,a.kt)("p",null,"RDMA\uff0c\u5168\u540d Remote Direct Memory Access\uff0c\u9867\u540d\u601d\u7fa9\u5c31\u662f\u9060\u7aef\u76f4\u63a5\u8a18\u61b6\u9ad4\u5b58\u53d6\uff0c\u6b64\u6280\u8853\u5176\u5be6\u662f\u6e90\u81ea\u65bc DMA (Direct Memory Access)\uff0c\u80fd\u5920\u5728\u4e0d\u727d\u626f\u5230 CPU \u7684\u524d\u63d0\u4e0b\u76f4\u63a5\u5b58\u53d6\u672c\u6a5f\u4e0a\u9762\u7684\u8a18\u61b6\u9ad4\u3002\u56e0\u6b64 RDMA \u5247\u662f\u5728\u6b64\u60c5\u63d0\u4e0a\u589e\u52a0\u4e86 ",(0,a.kt)("strong",{parentName:"p"},"Remote")," \u7684\u529f\u80fd\uff0c\u4ea6\u5373\u53ef\u4ee5\u9060\u7aef\u5b58\u53d6\u5176\u4ed6\u6a5f\u5668\u4e0a\u9762\u7684\u8a18\u61b6\u9ad4\u3002"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://linuxcluster.files.wordpress.com/2012/10/rdma_communication.jpg",alt:null})),(0,a.kt)("p",null,"\u6240\u4ee5 ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u5230\u5e95\u6709\u4ec0\u9ebc\u512a\u9ede\uff1f \u5f9e ",(0,a.kt)("a",{parentName:"p",href:"http://www.rdmamojo.com/"},"rdmamojo")," \u5f15\u7528\u4f86\u770b\uff0c\u81f3\u5c11\u6709\u4e94\u500b\u512a\u9ede\u503c\u5f97\u6211\u5011\u53bb\u63a2\u7a76"),(0,a.kt)("h2",{id:"advantages"},"Advantages"),(0,a.kt)("h3",{id:"zero-copy"},"Zero-Copy"),(0,a.kt)("p",null,"\u6b64\u7279\u6027\u5728 ",(0,a.kt)("strong",{parentName:"p"},"DMA")," \u4e2d\u5c31\u5df2\u7d93\u6709\u4e86\uff0c\u6211\u5011\u7528\u4e00\u500b\u7c21\u55ae\u7684\u7bc4\u4f8b\u4f86\u8aaa\u660e\u5176\u7528\u9014\u3002\n\u5728\u50b3\u7d71\u7684\u7db2\u8def\u61c9\u7528\u7a0b\u5f0f\u4e2d\uff0c\u4e00\u500b\u5c01\u5305\u7684\u8f49\u9001\u6703\u7d93\u904e\u4e0b\u5217\u6b65\u9a5f"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u5c01\u5305\u900f\u904e\u5a92\u4ecb\u9001\u5230\u7db2\u8def\u5361\uff0c\u96a8\u5f8c\u900f\u904e driver \u5c64\u7684\u8655\u7406\u5230\u9054\u4e86 ",(0,a.kt)("strong",{parentName:"li"},"kernel space")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"kernel space")," \u5167\u6aa2\u8996\u8a72\u5c01\u5305\u8207\u76f8\u95dc\u8cc7\u8a0a\uff0c\u627e\u5230\u8a72\u5c01\u5305\u6240\u5c6c\u7684 ",(0,a.kt)("strong",{parentName:"li"},"user space application"),"\uff0c\u4e26\u4e14\u6e96\u5099\u5c07\u6b64\u5c01\u5305\u8f49\u9001\u4e0a\u53bb"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"user space application")," \u6536\u5230\u5c01\u5305\u5167\u5bb9\uff0c\u9032\u884c\u8655\u7406\u5f8c\uff0c\u6e96\u5099\u5c07\u5c01\u5305\u9001\u51fa\u53bb"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"user space application")," \u60f3\u8981\u9001\u51fa\u7684\u5c01\u5305\u6703\u5148\u5230\u9054 ",(0,a.kt)("strong",{parentName:"li"},"kernel space"),"\uff0c\u5728 ",(0,a.kt)("strong",{parentName:"li"},"kernel")," \u4e00\u5c64\u4e00\u5c64\u8655\u7406\uff0c\u6700\u5f8c\u900f\u904e\u7db2\u8def\u5361\u5c07\u6b64\u5c01\u5305\u900f\u904e\u5a92\u4ecb\u9001\u51fa\u53bb\u3002")),(0,a.kt)("p",null,"\u5728\u4e0a\u8ff0\u7684\u904e\u7a0b\u4e2d\uff0c\u7576\u5c01\u5305\u5728 ",(0,a.kt)("strong",{parentName:"p"},"kernel space")," \u8207 ",(0,a.kt)("strong",{parentName:"p"},"user space")," \u4e4b\u9593\u8f49\u63db\u6642\uff0c\u7531\u65bc\u5176\u8a18\u61b6\u9ad4\u7a7a\u9593\u7684\u898f\u7bc4\u4e0d\u540c\uff0c\u56e0\u6b64\u6240\u6709\u7684\u8cc7\u6599\u90fd\u5fc5\u9808\u8981\u8907\u88fd\u4e00\u4efd\u65b0\u5f8c\u624d\u80fd\u5920\u5f80\u4e0a/\u4e0b\u8655\u7406\uff0c\u6240\u4ee5\u9019\u6a23\u81f3\u5c11\u5c31\u6703\u6709\u5169\u6b21\u8cc7\u6599\u8907\u88fd\u7684\u884c\u70ba\u6703\u51fa\u73fe\u3002\n\u800c ",(0,a.kt)("strong",{parentName:"p"},"Zero-Copy")," \u5f37\u8abf\u7684\u662f\u80fd\u5920\u6e1b\u5c11\u9019\u4e9b\u8cc7\u6599\u8907\u88fd\u7684\u884c\u70ba\uff0c\u751a\u81f3\u5c07\u8a72\u6b21\u6578\u7d66\u964d\u4f4e\u5230\u5b8c\u5168\u4e0d\u9700\u8981\uff0c\u9019\u90e8\u5206\u82e5\u6709\u786c\u9ad4\u7684\u5e6b\u52a9\uff0c\u5247\u751a\u81f3\u5c01\u5305\u90fd\u4e0d\u6703\u5728 ",(0,a.kt)("strong",{parentName:"p"},"kernel")," \u5167\u9032\u884c copy.\n\u8a73\u7d30\u5730\u5167\u5bb9\u53ef\u4ee5\u53c3\u8003 ",(0,a.kt)("a",{parentName:"p",href:"http://stenlyho.blogspot.tw/2008/08/zero-copy.html"},"\u53f2\u4e39\u5229\u90e8\u843d\u683c - \u4ec0\u9ebc\u662fZero-Copy?")),(0,a.kt)("h3",{id:"kernel-bypass"},"Kernel bypass"),(0,a.kt)("p",null,"\u6b64\u7279\u6027\u5f37\u8abf ",(0,a.kt)("strong",{parentName:"p"},"user space application")," \u80fd\u5920\u4e0d\u727d\u626f\u5230 ",(0,a.kt)("strong",{parentName:"p"},"kernel")," \u7684\u524d\u63d0\u4e0b\u76f4\u63a5\u8655\u7406\u8cc7\u6599\uff0c\u4ee5 ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u4f86\u8aaa\uff0c\u5176\u61c9\u7528\u7a0b\u5f0f\u53ef\u4ee5\u76f4\u63a5\u8ddf\u7db2\u5361\u6e9d\u901a\u76f4\u63a5\u53d6\u5f97\u8cc7\u6599\uff0c\u800c\u8a72\u8cc7\u6599\u5247\u4e0d\u9700\u8981\u518d\u7d93\u904e ",(0,a.kt)("strong",{parentName:"p"},"kernel")," \u5167\u4e00\u5c64\u53c8\u4e00\u5c64\u7684 ",(0,a.kt)("strong",{parentName:"p"},"network stack"),"\uff0c\u9019\u6a23\u4e5f\u53ef\u4ee5\u6e1b\u5c11\u4e0d\u5fc5\u8981\u7684 CPU \u904b\u7b97\u3002\n\u5176\u4ed6\u6280\u8853\u5982 ",(0,a.kt)("strong",{parentName:"p"},"DPDK"),", ",(0,a.kt)("strong",{parentName:"p"},"mmap")," \u4e5f\u662f\u6709\u4e00\u6a23\u7684\u7279\u6027\u3002"),(0,a.kt)("h3",{id:"no-cpu-involvement"},"No CPU involvement"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"application")," \u53ef\u4ee5\u5728\u4e0d\u6d88\u8017\u9060\u65b9\u6a5f\u5668 CPU \u7684\u524d\u63d0\u4e0b\u76f4\u63a5\u5c0d\u9060\u65b9\u6a5f\u5668\u4e0a\u7684\u8a18\u61b6\u9ad4\u9032\u884c\u64cd\u4f5c\u3002\u6b64\u5916\uff0c\u7531\u65bc\u9060\u65b9\u6a5f\u5668\u6839\u672c\u4e0d\u6703\u77e5\u9053\u67d0\u4e9b\u8a18\u61b6\u9ad4\u5df2\u7d93\u88ab\u4fee\u6539\u4e86\uff0c\u6240\u4ee5 CPU read cache \u4e5f\u4e0d\u6703\u6709\u4efb\u4f55\u7684\u4fee\u6539\u3002\n\u7576\u7136\u524d\u63d0\u662f\u5169\u65b9\u8981\u4e8b\u5148\u6709\u6e9d\u901a\u904e\uff0c\u5f7c\u6b64\u638c\u63e1\u4e00\u628a\u9470\u5319\u5f8c\uff0c\u624d\u53ef\u4ee5\u9019\u6a23\u9032\u884c\u4fee\u6539\u3002"),(0,a.kt)("h3",{id:"message-based-transactions"},"Message based transactions"),(0,a.kt)("p",null,"\u9019\u90e8\u5206\u5247\u662f\u6bd4\u8f03\u504f\u5411\u7a0b\u5f0f\u8a2d\u8a08\u8005\u8981\u6ce8\u610f\u7684\u90e8\u5206\uff0c ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u7684\u5c01\u5305\u6703\u4ee5 ",(0,a.kt)("strong",{parentName:"p"},"message")," \u7684\u65b9\u5f0f\u53bb\u50b3\u905e\uff0c\u800c\u4e0d\u662f ",(0,a.kt)("strong",{parentName:"p"},"stream")," \u7684\u65b9\u5f0f\uff0c\u610f\u5473\u8005\u61c9\u7528\u7a0b\u5f0f\u4e0d\u9700\u8981\u81ea\u5df1\u53bb\u89e3\u6790\u6574\u500b\u8cc7\u6599\u4e32\u6d41\u4f86\u53d6\u5f97\u6bcf\u4e00\u6b21\u50b3\u9001\u7684\u5167\u5bb9\u3002"),(0,a.kt)("h3",{id:"scattergather-entries-support"},"Scatter/Gather entries support"),(0,a.kt)("p",null,"\u6b64\u7279\u6027\u4e5f\u662f\u5f9e ",(0,a.kt)("strong",{parentName:"p"},"DMA")," \u5c31\u5df2\u7d93\u6709\u7684\uff0c\u61c9\u7528\u7a0b\u5f0f\u53ef\u4ee5\u900f\u904e\u6b64\u900f\u6027\u4e00\u53e3\u6c23\u9023\u7e8c\u7684\u5f9e\u591a\u500b\u7de9\u885d\u5340\u8b80\u53d6\u8cc7\u6599\uff0c\u7136\u5f8c\u900f\u904e\u8cc7\u6599\u4e32\u6d41\u7684\u65b9\u5f0f\u5beb\u51fa\u53bb\u3002\u6216\u662f\u5f9e\u8cc7\u6599\u4e32\u6d41\u8b80\u53d6\u8cc7\u6599\uff0c\u4e26\u4e14\u5c07\u8b80\u9032\u4f86\u7684\u8cc7\u6599\u7d66\u5beb\u5165\u591a\u500b\u7de9\u885d\u5340\u4e2d\u3002\u8a73\u7d30\u7684\u4ecb\u7d39\u53ef\u4ee5\u53c3\u8003 ",(0,a.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Vectored_I/O"},"Vectored_I/O")),(0,a.kt)("p",null,"\u6240\u4ee5\u6709\u4e86\u4e0a\u8ff0\u7684\u7279\u8272\uff0c ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u5230\u5e95\u80fd\u5e36\u4f86\u4ec0\u9ebc\u6a23\u7684\u512a\u52e2\uff1f"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"low-latency:"),(0,a.kt)("li",{parentName:"ol"},"high-throughput:"),(0,a.kt)("li",{parentName:"ol"},"low-CPU usage: \u900f\u904e ",(0,a.kt)("strong",{parentName:"li"},"RDMA")," \u6e1b\u5c11CPU\u5c0d\u65bc\u7db2\u8def\u529f\u80fd\u7684\u6d88\u8017\uff0c\u8b93 ",(0,a.kt)("strong",{parentName:"li"},"CPU")," \u80fd\u5920\u8655\u7406\u66f4\u591a\u5176\u4ed6\u7684\u4e8b\u60c5\u3002")),(0,a.kt)("p",null,"\u4e0d\u904e\u9019\u4e9b ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u4e26\u6c92\u6709\u4fdd\u8b49\u4e0a\u8ff0\u7684\u4e09\u500b\u7279\u6027\u662f\u80fd\u5920",(0,a.kt)("strong",{parentName:"p"},"\u540c\u6642"),"\u64c1\u6709\u7684\uff0c\n\u53ef\u4ee5\u5f9e ",(0,a.kt)("a",{parentName:"p",href:"http://www.rdmamojo.com/2013/06/08/tips-and-tricks-to-optimize-your-rdma-code/"},"Tips and tricks to optimize your RDMA code")," \u9019\u908a\u770b\u5230\uff0c\u91dd\u5c0d\u4e0d\u540c\u7684\u7279\u6027\uff0c ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u7684\u4f7f\u7528\u65b9\u5f0f\u90fd\u6703\u6709\u6240\u4e0d\u540c\uff0c\u7136\u800c\u9019\u4e9b\u65b9\u6cd5\u662f\u4e92\u76f8\u62b5\u89f8\u7684\u3002\n\u81f3\u65bc\u9019\u4e9b\u7d30\u7bc0\u5728\u4e0b\u9762\u6587\u7ae0\u6703\u518d\u6b21\u63d0\u5230\u3002"),(0,a.kt)("h2",{id:"architecture"},"Architecture"),(0,a.kt)("h3",{id:"architecture-1"},"Architecture"),(0,a.kt)("p",null,"\u9019\u908a\u4f7f\u7528\u4e00\u5f35\u5f9e",(0,a.kt)("a",{parentName:"p",href:"https://labs.vmware.com/vmtj/toward-a-paravirtual-vrdma-device-for-vmware-esxi-guests"},"\u7db2\u8def"),"\u4e0a\u627e\u5230\u7684\u5716\u4f86\u8aaa\u660e ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u7684\u67b6\u69cb\u3002\n\u8a72\u5716\u5206\u6210\u4e0a\u4e0b\u5169\u500b\u90e8\u5206\u4f86\u770b\uff0c\u4e0a\u90e8\u5206\u7531 ",(0,a.kt)("strong",{parentName:"p"},"Application/User/Kernel")," \u4f86\u7d44\u6210\uff0c\u800c\u4e0b\u90e8\u5206\u5c31\u662f\u5269\u4e0b\u90e8\u5206\u3002"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"http://i.imgur.com/qRmM40C.png",alt:null})),(0,a.kt)("h4",{id:"bsd-socket"},"BSD Socket"),(0,a.kt)("p",null,"\u4e0a\u534a\u90e8\u5206\u9019\u908a\u63a1\u7528\u5c0d\u6bd4\u7684\u65b9\u5f0f\u53bb\u5448\u73fe\uff0c\u5de6\u908a\u7684\u90e8\u5206\u662f\u7576 ",(0,a.kt)("strong",{parentName:"p"},"Application")," \u8981\u63a1\u7528 BSD Socket API \u6642\u8981\u8d70\u7684\u8def\u7dda\u3002\u9996\u5148\uff0c\u5728 ",(0,a.kt)("strong",{parentName:"p"},"Application")," \u6703\u6709\u672c\u5730\u81ea\u5df1\u7684 ",(0,a.kt)("strong",{parentName:"p"},"Buffers"),"\uff0c\u63a5\u4e0b\u4f86\u60f3\u8981\u5c07\u8a72",(0,a.kt)("strong",{parentName:"p"},"Buffer"),"\u5167\u7684\u8cc7\u6599\u9001\u51fa\u53bb\uff0c\u6240\u4ee5\u9019\u6642\u5019\u901a\u5e38\u6703\u4f7f\u7528 ",(0,a.kt)("strong",{parentName:"p"},"Send/Write..etc")," \u4e4b\u985e\u7684 API \u5c07\u5c01\u5305\u9001\u51fa\u53bb\u3002\u800c\u9019\u4e9b\u5c01\u5305\u900f\u904e ",(0,a.kt)("strong",{parentName:"p"},"System_Call")," \u7684\u65b9\u5f0f\u5230\u9054 ",(0,a.kt)("strong",{parentName:"p"},"kernel")," \u4e4b\u5f8c\uff0c\u5fc5\u9808\u8981\u5148\u8dd1\u904e\u6574\u500b ",(0,a.kt)("strong",{parentName:"p"},"Kernel Space"),"\u5167\u7684 ",(0,a.kt)("strong",{parentName:"p"},"Network Stack"),"\uff0c\u5305\u542b\u4e86 ",(0,a.kt)("strong",{parentName:"p"},"Layer4/Later3/Layer2")," \u4ee5\u53ca ",(0,a.kt)("strong",{parentName:"p"},"Socket")," \u9019\u4e00\u5c64\u7684\u8655\u7406\uff0c\u5728\u4e00\u5c64\u4e00\u5c64\u7684\u904e\u7a0b\u4e2d\uff0c\u5c01\u5305\u7684\u96db\u5f62\u6703\u9010\u6f38\u7522\u751f\uff0c\u5c0d\u61c9\u7684 ",(0,a.kt)("strong",{parentName:"p"},"Header")," \u6703\u88ab\u9010\u6f38\u52a0\u4e0a\u53bb\u3002"),(0,a.kt)("h4",{id:"rdma-side"},"RDMA Side"),(0,a.kt)("p",null,"\u6700\u5f8c\u7576\u6b64\u5c01\u5305\u5230\u9054 ",(0,a.kt)("strong",{parentName:"p"},"Driver")," \u9019\u5c64\u4e4b\u5f8c\uff0c\u5c31\u6703\u9806\u5229\u7684\u9001\u51fa\u53bb\u4e86\u3002\n\u53f3\u908a\u7684\u90e8\u5206\u5247\u662f\u5728\u63cf\u8ff0 ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u7684\u60c5\u6cc1\uff0c\u53ef\u4ee5\u770b\u5230\u6709\u5169\u500b\u4e0d\u4e00\u6a23"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"User-Space \u63a1\u7528\u7684 API \u4e0d\u540c\uff0c\u9019\u908a\u63a1\u7528\u7684\u662f ",(0,a.kt)("strong",{parentName:"li"},"RDMA Verbs API")),(0,a.kt)("li",{parentName:"ol"},"\u900f\u904e\u4e0a\u8ff0\u7684 API, \u5c01\u5305\u5167\u7684\u6771\u897f\u6703\u76f4\u63a5\u9001\u5230 ",(0,a.kt)("strong",{parentName:"li"},"Device Driver")," \u53bb\u8655\u7406\uff0c\u76f4\u63a5\u7565\u904e\u672c\u4f86\u7684 ",(0,a.kt)("strong",{parentName:"li"},"Network Stack"),"\uff0c\u6700\u5f8c\u5230\u9054 ",(0,a.kt)("strong",{parentName:"li"},"Host CHannel Adapter")," \u5f8c\u518d\u6839\u64da\u4e0d\u540c\u7684\u65b9\u5f0f\u8d70\u4e0d\u540c\u7684\u5354\u8b70\u51fa\u53bb\u3002")),(0,a.kt)("h4",{id:"protocol"},"Protocol"),(0,a.kt)("p",null,"\u4e0b\u534a\u90e8\u5206\u51fa\u73fe\u4e86\u4e09\u500b\u540d\u8a5e\uff0c\u5206\u5225\u662f ",(0,a.kt)("strong",{parentName:"p"},"InfiniBand"),", ",(0,a.kt)("strong",{parentName:"p"},"iWARP")," \u4ee5\u53ca ",(0,a.kt)("strong",{parentName:"p"},"RoCE"),"\u3002\nRDMA\u6b64\u6280\u8853\u8981\u5efa\u7acb\u5728\u9019\u4e09\u7a2e\u50b3\u8f38\u5354\u8b70\u4e0a\uff0c\u9019\u4e09\u7a2e\u5354\u8b70\u4e0d\u540c\u9ede\u5728\u65bc"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u67b6\u8a2d\u74b0\u5883\u4e0d\u540c\uff0c\u6240\u9700\u8981\u7684\u786c\u9ad4\u652f\u63f4\u80fd\u529b\u4e5f\u4e0d\u540c"),(0,a.kt)("li",{parentName:"ol"},"\u7528\u4f86\u50b3\u9001RDMA\u7684\u5c01\u5305\u683c\u5f0f\u4e5f\u4e0d\u540c\uff0c\u6709\u7684\u6703\u591a\u5305TCP\uff0c\u6709\u7684\u5305UDP\u3002")),(0,a.kt)("p",null,"\u6240\u4ee5\u5f9e\u5716\u4e2d\u53ef\u4ee5\u89c0\u5bdf\u5230\u5de6\u908a ",(0,a.kt)("strong",{parentName:"p"},"InfiniBand")," \u6709\u5f37\u8abf\u9700\u8981\u642d\u914d ",(0,a.kt)("strong",{parentName:"p"},"InfiniBand Switch")," \u624d\u53ef\u4ee5\u6b63\u5e38\u904b\u4f5c\uff0c\u800c\u53f3\u908a\u5169\u7a2e\u5354\u5b9a\u5247\u53ea\u9700\u8981 ",(0,a.kt)("strong",{parentName:"p"},"Ethernet Switch")," \u5373\u53ef\u904b\u4f5c\u3002"),(0,a.kt)("p",null,"\u9019\u908a\u7a0d\u5fae\u63d0\u4e00\u4e0b ",(0,a.kt)("strong",{parentName:"p"},"RoCE (RDMA over Converged Ethernet)"),"\u9019\u500b\u5354\u5b9a\uff0c\u6b64\u5354\u5b9a\u672c\u8eab\u4e5f\u6709\u6240\u8b02\u7684\u7248\u672c\u7684\u6f14\u9032\uff0c\u6700\u65e9\u671f\u7684 ",(0,a.kt)("strong",{parentName:"p"},"v1")," \u7248\u672c\u4e2d\u53ea\u6703\u6dfb\u52a0",(0,a.kt)("strong",{parentName:"p"},"Ethernet Header"),"\uff0c\u800c\u6c92\u6709\u66f4\u4e0a\u5c64\u7684 ",(0,a.kt)("strong",{parentName:"p"},"IP"),", ",(0,a.kt)("strong",{parentName:"p"},"TCP/UDP"),"\uff0c\u6240\u4ee5\u53ea\u80fd\u7528\u4f86 ",(0,a.kt)("strong",{parentName:"p"},"Layer2")," \u7684\u8f49\u767c\u3002\u5230\u4e86 ",(0,a.kt)("strong",{parentName:"p"},"v2")," \u7684\u7248\u672c\uff0c\u5247\u662f\u758a\u52a0\u4e86 ",(0,a.kt)("strong",{parentName:"p"},"IP")," \u4ee5\u53ca ",(0,a.kt)("strong",{parentName:"p"},"UDP")," \u5169\u7a2e ",(0,a.kt)("strong",{parentName:"p"},"header"),"\u3002\u8a73\u7d30\u7684\u4ecb\u7d39\u53ef\u4ee5\u53c3\u8003\n",(0,a.kt)("a",{parentName:"p",href:"http://weibo.com/p/1001603936363903889917"},"\u4e24\u79cd\u4ee5\u592a\u7f51 RDMA \u534f\u8bae\uff1a iWARP \u548c RoCE")),(0,a.kt)("p",null,"\u91dd\u5c0d ",(0,a.kt)("strong",{parentName:"p"},"RoCE")," \u6709\u500b\u6709\u8da3\u7684\u8b70\u984c\u5c31\u662f ",(0,a.kt)("strong",{parentName:"p"},"lossless network"),", \u5728\u6574\u500b\u5c01\u5305\u7684\u50b3\u8f38\u904e\u7a0b\u4e2d\uff0c\u7576\u767c\u9001\u7aef\u7121\u6b62\u76e1\u7684\u5c07\u5c01\u5305\u9001\u5f80\u5c0d\u9762\u6642\uff0c\u82e5\u5c0d\u9762\u7684\u6c92\u6709\u8db3\u5920\u7684\u80fd\u529b\u53bb\u627f\u53d7\u9019\u4e9b\u5c01\u5305\uff0c\u5c31\u6709\u53ef\u80fd\u767c\u751f\u5c01\u5305\u88ab\u4e1f\u68c4\u7684\u72c0\u614b\uff0c\u9019\u5c31\u6703\u5c0e\u81f4\u5c01\u5305\u907a\u5931\u3002\n\u82e5\u5c01\u5305\u6108\u5c11\u907a\u5931\uff0c\u5247\u6574\u9ad4\u6548\u80fd\u6108\u52a0\u3002\u6240\u4ee5\u9019\u90e8\u5206\u5f9e\u4e0a\u5c64\u7684\nTCP Congestion Control \u5230 Ethernet IEEE 802.3x \u898f\u7bc4\u7684 ",(0,a.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Ethernet_flow_control"},"Ethernet Flow Control"),"\u90fd\u5728\u81f4\u529b\u65bc\u6e1b\u5c11\u4e0a\u8ff0\u60c5\u6cc1\u3002"),(0,a.kt)("p",null,"\u56e0\u6b64\u5728 ",(0,a.kt)("strong",{parentName:"p"},"RoCE")," \u7684\u74b0\u5883\u4e2d\uff0c\u7531\u65bc\u6c92\u6709 ",(0,a.kt)("strong",{parentName:"p"},"TCP")," \u7684\u5e6b\u52a9\uff0c\u751a\u81f3\u5728 ",(0,a.kt)("strong",{parentName:"p"},"V1")," \u7684\u74b0\u5883\u4e0b\u53ea\u6709 ",(0,a.kt)("strong",{parentName:"p"},"Ethernet")," \u7684\u5b58\u5728\uff0c\u8981\u5982\u4f55\u9054\u5230 ",(0,a.kt)("strong",{parentName:"p"},"lossless network")," \u5c31\u662f\u4e00\u500b\u6709\u8da3\u7684\u8b70\u984c\u3002\n\u5728\u9019\u7bc7 Mellanox \u7684\u6587\u7ae0 ",(0,a.kt)("a",{parentName:"p",href:"http://www.mellanox.com/blog/2016/07/resilient-roce-relaxes-rdma-requirements/"},"resilient-roce-relaxes-rdma-requirements")," \u4ee5\u53ca ",(0,a.kt)("a",{parentName:"p",href:"https://community.mellanox.com/docs/DOC-2086#jive_content_id_Global_Pause_Flow_Control"},"HowTo Enable, Verify and Troubleshoot RDMA")," \u4e2d\u4ecb\u7d39\u4e86\u4e09\u7a2e\u65b9\u6cd5\u4f86\u9054\u6210 ",(0,a.kt)("strong",{parentName:"p"},"lossless network"),"\u3002\u5206\u5225\u662f"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Ethernet Flow Control (802.3x)"),(0,a.kt)("li",{parentName:"ol"},"PFC (Priority Flow Control)"),(0,a.kt)("li",{parentName:"ol"},"ECN (Explicit Congestion Notification)")),(0,a.kt)("p",null,"\u4e09\u7a2e\u8a73\u7d30\u7684\u4ecb\u7d39\u53ef\u4ee5\u5728\u4e0a\u8ff0\u9023\u7d50\u770b\u5230\uff0c\u6709\u8208\u8da3\u7684\u53ef\u4ee5\u81ea\u884c\u53c3\u95b1\u5b78\u7fd2\u3002"),(0,a.kt)("p",null,"\u7576 ",(0,a.kt)("strong",{parentName:"p"},"RoCE")," \u767c\u5c55\u5230 2016 \u5e74\u6642\uff0c\u5df2\u7d93\u767c\u5c55\u6210\u70ba\u4e86 ",(0,a.kt)("strong",{parentName:"p"},"Resilient RoCE"),"\uff0c\u5728\u6b64\u898f\u683c\u4e0b\uff0c",(0,a.kt)("strong",{parentName:"p"},"RoCE"),"\u5c0d\u65bc ",(0,a.kt)("strong",{parentName:"p"},"PFC"),"/",(0,a.kt)("strong",{parentName:"p"},"ENC")," \u53ef\u4ee5\u540c\u6642\u958b\u555f\uff0c\u4e5f\u53ef\u4ee5\u53ea\u958b\u555f\u4e00\u500b\uff0c\u4e26\u6c92\u6709\u898f\u5b9a\u4e00\u5b9a\u8981\u6709 ",(0,a.kt)("strong",{parentName:"p"},"PFC")," \u624d\u80fd\u5920\u904b\u884c\u3002\n\u5c31\u5982\u540c\u6587\u7ae0\u5167\u6240\u8ff0\u3002"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"RoCE can be deployed with ECN only, PFC only, or both, if you want to ensure your pants (or network flows) won\u2019t fall down.")),(0,a.kt)("h2",{id:"use-case"},"Use-Case"),(0,a.kt)("p",null,"\u770b\u4e86\u4e0a\u8ff0\u9019\u9ebc\u591a ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u7684\u512a\u9ede\uff0c\u6211\u5011\u4f86\u770b\u770b\u4e00\u4e9b\u70ba\u4ec0\u9ebc\u63a1\u7528 ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u7684\u5be6\u969b\u6848\u4f8b\u3002"),(0,a.kt)("h3",{id:"ceph"},"Ceph"),(0,a.kt)("p",null,"\u9019\u908a\u501f\u7528\u4e86 ",(0,a.kt)("strong",{parentName:"p"},"Haomai Wang"),"\u65bc OPENFABRICS ALLIANCE 2017 \u4e0a\u7684\u6295\u5f71\u7247 ",(0,a.kt)("a",{parentName:"p",href:"https://www.openfabrics.org/images/eventpresos/2017presentations/103_Ceph_HWang.pdf"},"CEPH RDMA UPDATE")),(0,a.kt)("p",null,"\u7b2c\u4e00\u5f35\u5716\u8aaa\u660e\u4e86\u76ee\u524d TCP \u7684\u6548\u80fd\u74f6\u9838\u554f\u984c\uff0c\u4e0d\u904e\u9019\u4e5f\u4e0d\u80fd\u602a TCP\uff0c\u7562\u7adf TCP \u7576\u521d\u8a2d\u8a08\u6642\u6240\u8003\u616e\u7684\u60c5\u6cc1\u672c\u4f86\u5c31\u6c92\u6709\u8fa6\u6cd5\u7b26\u5408\u6240\u6709\u7684\u4f7f\u7528\u8981\u6c42\uff0c\u4e0d\u7136 ",(0,a.kt)("strong",{parentName:"p"},"google")," \u600e\u9ebc\u6703\u5728\u4eca\u5e74\u516c\u958b ",(0,a.kt)("strong",{parentName:"p"},"BBR")," \u6f14\u7b97\u6cd5\u9032\u4e00\u6b65\u63d0\u5347 ",(0,a.kt)("strong",{parentName:"p"},"TCP")," \u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\u7684\u6548\u80fd\u5462\u3002\n\u6b64\u5916\u9019\u908a\u4e5f\u6709\u7279\u5225\u63d0\u5230 TCP \u7684 latency\uff0c\u7531\u65bc ",(0,a.kt)("strong",{parentName:"p"},"Ceph")," \u5206\u6563\u5f0f\u67b6\u69cb\u4e0a\u6bcf\u500b\u7bc0\u9ede\u4e4b\u9593\u90fd\u900f\u904e\u7db2\u8def\u4f86\u50b3\u9001\u8a0a\u606f\uff0c\u4e0d\u8ad6\u662f\u63a7\u5236\u5c01\u5305\u6216\u662f\u8cc7\u6599\u5c01\u5305\uff0c\u5176 ",(0,a.kt)("strong",{parentName:"p"},"latency"),"\u80fd\u5920\u6108\u4f4e\u7576\u7136\u662f\u6108\u597d\u3002\n",(0,a.kt)("img",{parentName:"p",src:"http://i.imgur.com/qkGVXyA.png",alt:null})),(0,a.kt)("p",null,"\u7b2c\u4e8c\u5f35\u5716\u5c31\u6bd4\u8f03\u6709\u610f\u601d\uff0c\u900f\u904e ",(0,a.kt)("strong",{parentName:"p"},"perf")," \u9032\u4e00\u6bb5\u6642\u9593 ",(0,a.kt)("strong",{parentName:"p"},"smaple")," \u5f8c\u7684\u8996\u89ba\u5316\u7684\u7d50\u679c\uff0c\u53ef\u4ee5\u89c0\u5bdf\u5230\u7576\u900f\u904e ",(0,a.kt)("strong",{parentName:"p"},"network")," \u53bb\u8ddf\u5176\u4ed6 ",(0,a.kt)("strong",{parentName:"p"},"node")," \u8b80\u53d6\u8cc7\u6599\u6642\uff0c\u76ee\u6e2c\u81f3\u5c11\u670920%\u7684\u6642\u9593\u90fd\u82b1\u8cbb\u5728 ",(0,a.kt)("strong",{parentName:"p"},"TCP")," \u672c\u8eab\u50b3\u9001\u5c01\u5305\u7684\u8655\u7406\u4e0a\u3002\n\u9019\u4e5f\u610f\u5473\u8005",(0,a.kt)("strong",{parentName:"p"},"Networking"),"\u9019\u908a\u81f3\u5c11\u670920%\u7684\u90e8\u5206\u53ef\u4ee5\u6295\u8cc7\u53bb\u52a0\u5f37\uff0c\u53ef\u4ee5\u5617\u8a66\u6e1b\u5c11\u5176 ",(0,a.kt)("strong",{parentName:"p"},"CPU Usage"),"\u3002\n",(0,a.kt)("img",{parentName:"p",src:"http://i.imgur.com/OjJtedB.png",alt:null})),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"CEPH")," \u70ba\u4e86\u89e3\u6c7a\u76ee\u524d ",(0,a.kt)("strong",{parentName:"p"},"TCP")," \u9020\u6210\u7684\u6548\u80fd\u74f6\u9838\uff0c\u5728 ",(0,a.kt)("strong",{parentName:"p"},"Networking")," \u5247\u63d0\u4f9b\u4e86 DPDK \u7684\u4f7f\u7528\uff0c(\u6700\u65e9\u4e4b\u524d\u5176\u5be6 Ceph \u5c31\u6709\u652f\u63f4 RDMA \u4e86\uff0c\u4e0d\u904e\u9019\u908a\u662f\u727d\u626f\u5230\u7b2c\u4e09\u65b9\u51fd\u5f0f\u5eab ",(0,a.kt)("strong",{parentName:"p"},"Accelio"),"\uff0c\u6240\u4ee5\u4e0d\u6b78\u985e\u5728 ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u539f\u751f\u67b6\u69cb\u4e0b\u7684\u652f\u6301)"),(0,a.kt)("p",null,"\u5f8c\u4f86\u7d93\u7531\u5927\u9678\u516c\u53f8 ",(0,a.kt)("strong",{parentName:"p"},"XSKY")," \u7684\u5e6b\u5fd9\uff0c\u63a8\u51fa\u4e86 SPDK + DPDK \u7684\u7d44\u5408\uff0c\u4e5f\u5e6b ",(0,a.kt)("strong",{parentName:"p"},"Ceph")," \u63d0\u4f9b\u4e86\u53e6\u5916\u4e00\u7a2e\u9078\u64c7\u3002"),(0,a.kt)("p",null,"\u4e0d\u904e\u76ee\u524d ",(0,a.kt)("strong",{parentName:"p"},"SPDK")," \u6703\u7528\u5230 ",(0,a.kt)("strong",{parentName:"p"},"DPDK")," \u4e14 ",(0,a.kt)("strong",{parentName:"p"},"DPDK")," \u672c\u8eab\u5f8c\u4f86\u7248\u672c\u7684 API \u6539\u52d5\uff0c\u4f7f\u5f97 ",(0,a.kt)("strong",{parentName:"p"},"SPDK")," \u9019\u908a\u5728\u9023\u7d50 ",(0,a.kt)("strong",{parentName:"p"},"DPDK")," \u7684\u90e8\u5206\u6709\u9ede\u5c0f\u554f\u984c\uff0c\u8981\u4f7f\u7528\u4e0a\u66f4\u9700\u8981\u82b1\u4e00\u4e9b\u6642\u9593\u53bb\u4fee\u6b63\u3002"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"XSKY")," \u5b8c\u6210 ",(0,a.kt)("strong",{parentName:"p"},"DPDK")," + ",(0,a.kt)("strong",{parentName:"p"},"SDPK")," \u5f8c\uff0c\u5c31\u5982\u540c\u5176\u6295\u5f71\u7247\u88e1\u9762\u8ff0\u8aaa\u7684\u554f\u984c"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"http://i.imgur.com/PZYFllQ.jpg",alt:null})),(0,a.kt)("p",null,"\u65bc\u662f\u4e4e ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u7684\u958b\u767c\u5c31\u6210\u4e86\u53e6\u5916\u4e00\u689d\u65b0\u95e2\u7684\u8def\u5f91\uff0c\u800c\u9019\u908a\u76ee\u524d\u4e5f\u9084\u5728\u6301\u7e8c\u958b\u767c\u4e2d\uff0c\u5f9e 2016~2017 ceph mailling list \u4e0a\u9762\u7684\u8a0e\u8ad6\u53ef\u4ee5\u89c0\u5bdf\u5230\u76ee\u524d ",(0,a.kt)("strong",{parentName:"p"},"Ceph With RDMA")," \u9084\u5728\u6210\u9577\u4e2d\uff0c\u76ee\u524d\u5148\u8ffd\u6c42\u7a69\u5b9a\u6027\uff0c\u7a69\u5b9a\u5f8c\u518d\u6c42\u6548\u80fd\u3002"),(0,a.kt)("p",null,"\u4f7f\u7528 2017/04 \u5e74\u5de6\u53f3 ",(0,a.kt)("strong",{parentName:"p"},"master")," \u7248\u672c\u9032\u884c RDMA \u6548\u80fd\u6e2c\u8a66\u5f97\u5230\u7684\u6578\u64da\u986f\u793a\uff0c\u76ee\u524d\u7684 ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u9084\u6c92\u6709\u8fa6\u6cd5\u5e36\u4f86\u592a\u591a\u7684\u512a\u52e2\uff0c\u4e0d\u8ad6\u662f\u964d\u4f4e ",(0,a.kt)("strong",{parentName:"p"},"latency")," \u6216\u662f\u6e1b\u5c11 CPU \u4f7f\u7528\u91cf\uff0c\u9019\u90e8\u5206\u90fd\u9084\u8981\u4f9d\u9760\u793e\u7fa4\u5167\u7e7c\u7e8c\u958b\u767c\u4f7f\u5176\u6210\u719f\u3002"),(0,a.kt)("h3",{id:"drbd"},"DRBD"),(0,a.kt)("p",null,"DRBD(distributed replicated block device) \u4e5f\u662f\u4e00\u500b\u77e5\u540d\u7684\u5206\u6563\u5f0f ",(0,a.kt)("strong",{parentName:"p"},"block")," \u5c64\u7d1a\u7684\u8907\u88fd\u6280\u8853\uff08\u8edf\u9ad4?)\u3002\u7531\u65bc\u662f\u5206\u6563\u5f0f\u7684\u67b6\u69cb\uff0c\u5176\u4e2d\u9593\u8cc7\u6599\u7684\u50b3\u8f38\u4e5f\u662f\u4f9d\u8cf4\u7db2\u8def\u4f86\u8655\u7406\u3002 DRBD \u4e00\u958b\u59cb\u53ea\u6709\u63d0\u4f9b ",(0,a.kt)("strong",{parentName:"p"},"TCP")," \u4f5c\u70ba\u5176\u50b3\u8f38\u5354\u5b9a\uff0c\u76f4\u5230\u4e86 2015 \u5e74\u624d\u958b\u59cb\u63d0\u4f9b\u4e86 ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u7684\u65b9\u5f0f\u4f86\u8655\u7406\u3002\n\u4e0d\u904e\u76f8\u5c0d\u65bc ",(0,a.kt)("strong",{parentName:"p"},"CEPH")," \u7684\u958b\u653e\uff0c ",(0,a.kt)("strong",{parentName:"p"},"DRBD with RDMA")," \u5247\u662f\u4e00\u500b\u5546\u696d\u7248\u672c\u624d\u6709\u7684\u652f\u63f4\uff08\u5c31\u662f\u8981\u4ed8\u9322$$$)\uff0c\u6240\u4ee5\u9019\u908a\u6c92\u6709\u8fa6\u6cd5\u91dd\u5c0d\u5176\u6548\u80fd\u9032\u884c\u6e2c\u91cf\u4f86\u8a55\u6e2c\u770b\u770b\u5176\u6548\u679c\u3002\n\u4e0d\u904e\u5b98\u65b9\u7db2\u7ad9\u4e0a\u5012\u662f\u6709\u4e0d\u5c11\u7bc7\u6587\u7ae0\u5728\u8b1b ",(0,a.kt)("strong",{parentName:"p"},"RDMA"),"\uff0c\u5305\u62ec\u4e86"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.linbit.com/en/what-is-rdma/"},"what-is-rdma")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"http://www.linbit.com/en/drbd-9-over-rdma-with-micron-ssds/"},"drbd-9-over-rdma-with-micron-ssds")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.linbit.com/en/rdma-performance/"},"rdma-performance"))),(0,a.kt)("p",null,"\u9019\u5169\u500b\u5206\u6563\u5f0f\u8edf\u9ad4\u5728\u5176\u7db2\u8def\u50b3\u8f38\u4e2d\u90fd\u6709\u63d0\u4f9b ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u7684\u65b9\u5f0f\uff0c\u9664\u4e86\u5176\u958b\u653e\u7a0b\u5ea6\u7684\u4e0d\u540c\u5916\uff0c\u5169\u8005\u5728\u5be6\u4f5c\u7684\u5c64\u7d1a\u4e5f\u4e0d\u592a\u4e00\u6a23\u3002\n",(0,a.kt)("strong",{parentName:"p"},"CEPH")," \u5c07 RDMA \u5be6\u4f5c\u5728 ",(0,a.kt)("strong",{parentName:"p"},"User-space"),"\uff0c\u800c ",(0,a.kt)("strong",{parentName:"p"},"DRBD")," \u5247\u5be6\u4f5c\u5728 ",(0,a.kt)("strong",{parentName:"p"},"Kernel-space"),"\uff0c\u4e26\u4e14\u4ee5 ",(0,a.kt)("strong",{parentName:"p"},"kernel module")," \u7684\u65b9\u5f0f\u63d0\u4f9b\u6b64\u529f\u80fd\uff0c\u56e0\u6b64\u82e5\u6709\u8ddf ",(0,a.kt)("strong",{parentName:"p"},"linbit")," \u8ac7\u597d\u76f8\u95dc\u7684\u5546\u696d\u884c\u70ba\uff0c\u5c31\u53ef\u4ee5\u7372\u5f97\u64c1\u6709 ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u529f\u80fd\u7684 ",(0,a.kt)("strong",{parentName:"p"},"kernel module"),"\u4f86\u4f7f\u7528\u3002"),(0,a.kt)("h2",{id:"summary"},"Summary"),(0,a.kt)("p",null,"\u672c\u7bc7\u6587\u7ae0\u4e3b\u8981\u662f\u4ee5\u6982\u5ff5\u7684\u65b9\u5f0f\u4f86\u4ecb\u7d39 ",(0,a.kt)("strong",{parentName:"p"},"RDMA"),"\uff0c\u6bd4\u8f03\u5c6c\u65bc\u79d1\u666e\u65b9\u9762\u7684\u4ecb\u7d39\u3002\n\u63a5\u4e0b\u4f86\u5247\u6703\u6709\u4e00\u7bc7\u6587\u7ae0\u6703\u4ee5 ",(0,a.kt)("strong",{parentName:"p"},"Programmer")," \u7684\u89d2\u5ea6\u53bb\u770b\u5f85 ",(0,a.kt)("strong",{parentName:"p"},"RDMA"),"\uff0c\u5305\u542b\u5176\u4e09\u7a2e ",(0,a.kt)("strong",{parentName:"p"},"Operation"),"(",(0,a.kt)("strong",{parentName:"p"},"SEND/RECEIVE"),", ",(0,a.kt)("strong",{parentName:"p"},"RDMA Write")," \u4ee5\u53ca ",(0,a.kt)("strong",{parentName:"p"},"RDMA Read"),") \u4ee5\u53ca\u900f\u904e ",(0,a.kt)("strong",{parentName:"p"},"ceph")," \u6b64 ",(0,a.kt)("strong",{parentName:"p"},"Project")," \u70ba\u7bc4\u4f8b\u4f86\u5b78\u7fd2\u8981\u5982\u4f55\u64b0\u5beb\u4e00\u500b ",(0,a.kt)("strong",{parentName:"p"},"RDMA")," \u7684\u61c9\u7528\u7a0b\u5f0f\u3002"),(0,a.kt)("h2",{id:"reference"},"Reference"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Vectored_I/O"},"Vectored_I/O"),"\n",(0,a.kt)("a",{parentName:"p",href:"http://stenlyho.blogspot.tw/2008/08/zero-copy.html"},"\u53f2\u4e39\u5229\u90e8\u843d\u683c"),"\n",(0,a.kt)("a",{parentName:"p",href:"http://www.rdmamojo.com/"},"rdmamojo"),"\n",(0,a.kt)("a",{parentName:"p",href:"https://www.openfabrics.org/images/eventpresos/2017presentations/103_Ceph_HWang.pdf"},"Openfabrics-Ceph RDMA Update"),"\n",(0,a.kt)("a",{parentName:"p",href:"https://labs.vmware.com/vmtj/toward-a-paravirtual-vrdma-device-for-vmware-esxi-guests"},"toward-a-paravirtual-vrdma-device-for-vmware-esxi-guests"),"\n",(0,a.kt)("a",{parentName:"p",href:"http://www.mellanox.com/blog/2016/07/resilient-roce-relaxes-rdma-requirements/"},"resilient-roce-relaxes-rdma-requirements"),"\n",(0,a.kt)("a",{parentName:"p",href:"http://weibo.com/p/1001603936363903889917"},"\u4e24\u79cd\u4ee5\u592a\u7f51 RDMA \u534f\u8bae\uff1a iWARP \u548c RoCE"),"\n",(0,a.kt)("a",{parentName:"p",href:"https://linuxcluster.wordpress.com/category/network/rdma/"},"Linux Cluster")))}c.isMDXComponent=!0}}]);