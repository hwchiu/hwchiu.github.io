"use strict";(self.webpackChunkhwchiu=self.webpackChunkhwchiu||[]).push([[88206],{3905:(e,t,l)=>{l.d(t,{Zo:()=>u,kt:()=>h});var n=l(67294);function a(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}function r(e,t){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),l.push.apply(l,n)}return l}function o(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{};t%2?r(Object(l),!0).forEach((function(t){a(e,t,l[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):r(Object(l)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(l,t))}))}return e}function s(e,t){if(null==e)return{};var l,n,a=function(e,t){if(null==e)return{};var l,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)l=r[n],t.indexOf(l)>=0||(a[l]=e[l]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)l=r[n],t.indexOf(l)>=0||Object.prototype.propertyIsEnumerable.call(e,l)&&(a[l]=e[l])}return a}var m=n.createContext({}),i=function(e){var t=n.useContext(m),l=t;return e&&(l="function"==typeof e?e(t):o(o({},t),e)),l},u=function(e){var t=i(e.components);return n.createElement(m.Provider,{value:t},e.children)},p="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},k=n.forwardRef((function(e,t){var l=e.components,a=e.mdxType,r=e.originalType,m=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=i(l),k=a,h=p["".concat(m,".").concat(k)]||p[k]||c[k]||r;return l?n.createElement(h,o(o({ref:t},u),{},{components:l})):n.createElement(h,o({ref:t},u))}));function h(e,t){var l=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=l.length,o=new Array(r);o[0]=k;var s={};for(var m in t)hasOwnProperty.call(t,m)&&(s[m]=t[m]);s.originalType=e,s[p]="string"==typeof e?e:a,o[1]=s;for(var i=2;i<r;i++)o[i]=l[i];return n.createElement.apply(null,o)}return n.createElement.apply(null,l)}k.displayName="MDXCreateElement"},93609:(e,t,l)=>{l.r(t),l.d(t,{assets:()=>m,contentTitle:()=>o,default:()=>c,frontMatter:()=>r,metadata:()=>s,toc:()=>i});var n=l(87462),a=(l(67294),l(3905));const r={title:"Rancher Fleet.yaml \u6a94\u6848\u63a2\u8a0e",sidebar_position:25,tags:["iThome","GitOps","Fleet","Kubernetes","Rancher"],description:"iThome-2021 \u7cfb\u5217\u6587\u7ae0"},o="\u524d\u8a00",s={unversionedId:"techPost/2021/iThome_Challenge/day25",id:"techPost/2021/iThome_Challenge/day25",title:"Rancher Fleet.yaml \u6a94\u6848\u63a2\u8a0e",description:"iThome-2021 \u7cfb\u5217\u6587\u7ae0",source:"@site/docs/techPost/2021/iThome_Challenge/day25.md",sourceDirName:"techPost/2021/iThome_Challenge",slug:"/techPost/2021/iThome_Challenge/day25",permalink:"/docs/techPost/2021/iThome_Challenge/day25",draft:!1,tags:[{label:"iThome",permalink:"/docs/tags/i-thome"},{label:"GitOps",permalink:"/docs/tags/git-ops"},{label:"Fleet",permalink:"/docs/tags/fleet"},{label:"Kubernetes",permalink:"/docs/tags/kubernetes"},{label:"Rancher",permalink:"/docs/tags/rancher"}],version:"current",sidebarPosition:25,frontMatter:{title:"Rancher Fleet.yaml \u6a94\u6848\u63a2\u8a0e",sidebar_position:25,tags:["iThome","GitOps","Fleet","Kubernetes","Rancher"],description:"iThome-2021 \u7cfb\u5217\u6587\u7ae0"},sidebar:"techPost",previous:{title:"Rancher Fleet \u73a9\u8f49\u7b2c\u4e00\u500b GitOps",permalink:"/docs/techPost/2021/iThome_Challenge/day24"},next:{title:"Rancher Fleet Kubernetes \u61c9\u7528\u7a0b\u5f0f\u90e8\u7f72",permalink:"/docs/techPost/2021/iThome_Challenge/day26"}},m={},i=[],u={toc:i},p="wrapper";function c(e){let{components:t,...l}=e;return(0,a.kt)(p,(0,n.Z)({},u,l,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"\u524d\u8a00"},"\u524d\u8a00"),(0,a.kt)("p",null,"\u524d\u7bc7\u6587\u7ae0\u7528\u5f88\u7c21\u6613\u7684\u65b9\u5f0f\u53bb\u63a2\u8a0e\u5982\u4f55\u4f7f\u7528 Fleet \u7684 GitOps \u6982\u5ff5\u4f86\u7ba1\u7406\u8cc7\u6e90\uff0c\u6700\u5f8c\u9762\u7528\u4e00\u500b\u975e\u5e38\u7c21\u6613\u7684 Deployment \u7269\u4ef6\u4f86\u5c55\u793a\u5982\u4f55\u8b93 Fleet \u5c07\u8a72\u8cc7\u6e90\u90e8\u7f72\u5230\u4e09\u500b\u53e2\u96c6\u4e2d\u3002"),(0,a.kt)("p",null,"\u5be6\u52d9\u4e0a\u4f7f\u7528\u7684\u60c5\u5883\u6703\u66f4\u52a0\u8907\u96dc\uff0c\u8b6c\u5982\u8aaa"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u61c9\u7528\u7a0b\u5f0f\u4f86\u6e90\u4e0d\u540c\uff0c\u6709\u7684\u662f\u7d14 YAML \u6a94\u6848\uff0c\u6709\u7684\u662f\u900f\u904e Helm \u5305\u88dd\uff0c\u6709\u7684\u662f\u900f\u904e Kustomize \u53bb\u5305\u88dd"),(0,a.kt)("li",{parentName:"ol"},"\u5e0c\u671b\u91dd\u5c0d\u4e0d\u540c\u53e2\u96c6\u6709\u4e0d\u540c\u5ba2\u88fd\u5316\uff0c\u4ee5 Helm \u4f86\u8aaa\u53ef\u80fd\u4e0d\u540c\u7684\u53e2\u96c6\u8981\u7d66\u4e0d\u540c\u7684 values.yaml")),(0,a.kt)("p",null,"\u56e0\u6b64\u63a5\u4e0b\u4f86\u7684\u6587\u7ae0\u5c31\u6703\u91dd\u5c0d\u4e0a\u8ff0\u5169\u500b\u6982\u5ff5\u4f86\u63a2\u8a0e\uff0c\u5230\u5e95\u65bc Fleet \u4e2d\u8981\u5982\u4f55\u6eff\u8db3\u4e0a\u8ff0\u8981\u6c42\u3002"),(0,a.kt)("h1",{id:"gitrepo-\u6383\u63cf\u65b9\u5f0f"},"GitRepo \u6383\u63cf\u65b9\u5f0f"),(0,a.kt)("p",null,"Fleet \u4e2d\u8981\u5148\u6e96\u5099 GitRepo \u7684\u7269\u4ef6\uff0c\u8a72\u7269\u4ef6\u4e2d\u6703\u63cf\u8ff0"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Git URL"),(0,a.kt)("li",{parentName:"ol"},"\u6a94\u6848\u7684\u8def\u5f91\u4f86\u6e90")),(0,a.kt)("p",null,"\u6e96\u5099\u597d\u8a72 GitRepo \u7269\u4ef6\u5f8c\uff0c Fleet \u5c31\u6703\u53bb\u6383\u63cf\u8a72 Git \u5c08\u6848\u4e26\u4e14\u6383\u63cf\u5e95\u4e0b\u7684\u8def\u5f91\uff0c\u63a5\u8005\u5f9e\u88e1\u9762\u627e\u51fa\u53ef\u4ee5\u4f7f\u7528\u7684 Kubernetes \u8cc7\u6e90\u6a94\u6848\u3002"),(0,a.kt)("p",null,"\u5be6\u969b\u4e0a Fleet \u7684\u904b\u4f5c\u908f\u8f2f\u66f4\u52a0\u8907\u96dc\uff0c\u56e0\u70ba Fleet \u652f\u63f4\u4e0b\u5217\u5e7e\u7a2e\u8b8a\u5316"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u539f\u751f YAML \u6a94\u6848"),(0,a.kt)("li",{parentName:"ol"},"Helm Chart"),(0,a.kt)("li",{parentName:"ol"},"Kustomize")),(0,a.kt)("p",null,"\u9019\u4e09\u7a2e\u8b8a\u5316\u5927\u62b5\u4e0a\u53ef\u4ee5\u5206\u6210\u4e94\u7a2e\u4e0d\u540c\u7684\u6a94\u6848\u4f86\u6e90\uff0c\u5206\u5225\u662f"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Chart.yaml"),(0,a.kt)("li",{parentName:"ol"},"kustomization.yaml"),(0,a.kt)("li",{parentName:"ol"},"fleet.yaml"),(0,a.kt)("li",{parentName:"ol"},"*.yaml"),(0,a.kt)("li",{parentName:"ol"},"overlays/{name}")),(0,a.kt)("p",null,"Helm Chart \u672c\u8eab\u53c8\u5206\u6210\u5169\u7a2e\u90e8\u7f72\u65b9\u5f0f\uff0c\u5206\u5225\u662f"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u4f7f\u7528\u9060\u65b9\u7684 Helm Server"),(0,a.kt)("li",{parentName:"ol"},"\u5c07 Helm Chart \u76f4\u63a5\u653e\u5230 Git \u5c08\u6848\u4e2d\uff0c\u6240\u4ee5\u5c08\u6848\u5167\u6703\u6709 charts.yaml, templates \u7b49\u6a94\u6848\u3002")),(0,a.kt)("p",null,"\u5c07\u4e0a\u8ff0\u7684\u6982\u5ff5\u6574\u5408\u8acb\u4f86\u5927\u62b5\u4e0a\u5c31\u662f"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u7576\u8def\u5f91\u4e0a\u6709 Chart.yaml \u6a94\u6848\u6642\uff0cFleet \u5c31\u6703\u8a8d\u70ba\u8981\u4f7f\u7528 Helm Chart \u7684\u6982\u5ff5\u53bb\u90e8\u7f72"),(0,a.kt)("li",{parentName:"ol"},"\u7576\u8def\u5f91\u4e0a\u6709 kustomization.yaml \u6a94\u6848\u6642\uff0c Fleet \u5c31\u6703\u8a8d\u70ba\u8981\u4f7f\u7528 Kustomize \u7684\u65b9\u5f0f\u4f86\u90e8\u7f72\u61c9\u7528\u7a0b\u5f0f"),(0,a.kt)("li",{parentName:"ol"},"\u7576\u8def\u5f91\u4e0a\u6709 fleet.yaml \u6a94\u6848\u6642\uff0c Fleet \u6703\u4f9d\u7167\u8a72\u6a94\u6848\u4e2d\u7684\u4f5c\u6cd5\u53bb\u90e8\u7f72\uff0c\u5be6\u52d9\u4e0a\u90fd\u6703\u4f7f\u7528 fleet.yaml \u53bb\u63cf\u8ff0\u90e8\u7f72\u7684\u7b56\u7565"),(0,a.kt)("li",{parentName:"ol"},"\u7576\u8def\u5f91\u4e0a\u6c92\u6709 Chart.yaml \u8207 kustomization.yaml \u6642\uff0cFleet \u5c31\u6703\u4f7f\u7528\u6700\u76f4\u89ba\u7684 Kubernetes \u8cc7\u6e90\u53bb\u90e8\u7f72"),(0,a.kt)("li",{parentName:"ol"},"overlays/{name} \u9019\u662f\u91dd\u5c0d(4)\u60c5\u6cc1\u4f7f\u7528\u7684\u5ba2\u88fd\u5316\u90e8\u7f72\uff0c\u662f\u5c08\u9580\u91dd\u5c0d\u7d14 Kubernetes \u8cc7\u6e90\u7684\u5ba2\u88fd\u5316\u3002")),(0,a.kt)("p",null,"\u524d\u7bc7\u6587\u7ae0\u53ea\u6709\u6e96\u5099\u4e00\u500b deployment.yaml\uff0c\u6240\u4ee5\u5c31\u6703\u8e29\u5230 (4) \u9019\u7a2e\u90e8\u7f72\u65b9\u5f0f\u3002\u5be6\u52d9\u4e0a\u6700\u5e38\u4f7f\u7528\u7684\u5c31\u662f fleet.yaml\uff0cfleet.yaml \u53ef\u4ee5\u76f4\u89ba\u53bb\u5448\u73fe\u6bcf\u500b\u61c9\u7528\u7a0b\u5f0f\u91dd\u5c0d\u4e0d\u540c\u53e2\u96c6\u7684\u5ba2\u88fd\u5316\u8a2d\u5b9a\uff0c\u540c\u6642\u9084\u53ef\u4ee5\u505a\u5230\u6df7\u5408\u7684\u6548\u679c\uff0c\u8b6c\u5982\u55ae\u7d14\u4f7f\u7528 Helm Chart, \u55ae\u7368\u4f7f\u7528 Kustomize\uff0c\u6216\u662f\u5148 Helm Chart \u518d Kustomize \u7684\u6df7\u5408\u90e8\u7f72\u3002"),(0,a.kt)("p",null,"\u6240\u4ee5\u53ef\u4ee5\u77e5\u9053 Fleet.yaml \u53ef\u4ee5\u662f\u6574\u500b Fleet \u90e8\u7f72\u7684\u91cd\u8981\u7cbe\u9748\u8207\u9748\u9b42\uff0c\u6240\u6709\u7684\u61c9\u7528\u7a0b\u5f0f\u90fd\u9700\u8981\u6e96\u5099\u4e00\u500b fleet.yaml"),(0,a.kt)("h1",{id:"fleetyaml"},"Fleet.yaml"),(0,a.kt)("p",null,"Fleet.yaml \u662f\u4e00\u500b\u7528\u4f86\u63a7\u5236 Fleet \u5982\u4f55\u53bb\u8655\u7406\u7576\u524d\u8cc7\u6599\u593e\u4e0b\u7684 YAML \u6a94\u6848\uff0c\u8a72\u7528\u4ec0\u9ebc\u65b9\u5f0f\u8655\u7406\u4ee5\u53ca\u4e0d\u540c\u7684\u53e2\u96c6\u61c9\u8a72\u8981\u5982\u4f55\u5ba2\u88fd\u5316\u3002\n\u6bcf\u4e00\u500b fleet.yaml \u90fd\u6703\u88ab\u7522\u751f\u4e00\u500b\u5c0d\u61c9\u7684 Fleet Bundle \u7269\u4ef6\uff0c\u6240\u4ee5\u901a\u5e38\u6703\u5c07 fleet.yaml \u653e\u5230\u6bcf\u500b\u61c9\u7528\u7a0b\u5f0f\u7684\u6700\u4e0a\u5c64\u8def\u5f91\u3002"),(0,a.kt)("p",null,"Fleet.Yaml \u7684\u8a73\u7d30\u5167\u5bb9\u5982\u4e0b\uff0c\u63a5\u4e0b\u4f86\u6839\u64da\u6bcf\u500b\u6b04\u4f4d\u4ecb\u7d39\u4e00\u4e0b"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-YAML="},"\ndefaultNamespace: default\n\nnamespace: default\n\nkustomize:\n  dir: ./kustomize\n\nhelm:\n  chart: ./chart\n  repo: https://charts.rancher.io\n  releaseName: my-release\n  constraint\n  version: 0.1.0\n  during\n  values:\n    any-custom: value\n  valuesFiles:\n    - values1.yaml\n    - values2.yaml\n  force: false\n\npaused: false\n\nrolloutStrategy:\n    maxUnavailable: 15%\n    maxUnavailablePartitions: 20%\n    autoPartitionSize: 10%\n    partitions:\n    - name: canary\n      maxUnavailable: 10%\n      clusterSelector:\n        matchLabels:\n          env: prod\n      clusterGroup: agroup\n      clusterGroupSelector: agroup\n\ntargetCustomizations:\n- name: prod\n  namespace: newvalue\n  kustomize: {}\n  helm: {}\n  yaml:\n    overlays:\n    - custom2\n    - custom3\n  specified,\n  clusterSelector:\n    matchLabels:\n      env: prod\n  clusterGroupSelector:\n    matchLabels:\n      region: us-east\n  clusterGroup: group1\n")),(0,a.kt)("p",null,"defaultNamespace/namespace\ndefaultNamespace \u4ee3\u8868\u7684\u662f\u5982\u679c Kubernetes YAML \u8cc7\u6e90\u6c92\u6709\u6a19\u793a namespace \u7684\u8a71\uff0c\u6703\u81ea\u52d5\u7684\u88ab\u90e8\u7f72\u5230\u9019\u500b defaultNamespace \u6240\u6307\u5411\u7684\u4f4d\u7f6e\u3002"),(0,a.kt)("p",null,"namespace \u5247\u662f\u5f37\u8feb\u5c07\u6240\u6709\u8cc7\u6e90\u7d66\u5b89\u88dd\u5230\u67d0\u500b namespace \u4e2d\uff0c\u8981\u7279\u5225\u6ce8\u610f\u7684\u662f\u5982\u679c\u76ee\u6a19 namespace \u4e2d\u5df2\u7d93\u6709\u91cd\u8907\u7684\u8cc7\u6e90\u7684\u8a71\uff0c\u5b89\u88dd\u53ef\u80fd\u6703\u5931\u6557\uff0c\u9019\u9ede\u8ddf\u6b63\u5e38\u7684 kubernetes \u8cc7\u6e90\u4e00\u6a23\u3002"),(0,a.kt)("p",null,"kustomize:\n\u719f\u6089 kustomize \u7684\u670b\u53cb\u4e00\u5b9a\u90fd\u77e5\u9053 kustomize \u7fd2\u6163\u4e0a\u90fd\u6703\u900f\u904e\u4e00\u500b\u53c8\u4e00\u500b\u8cc7\u6599\u593e\u642d\u914d kustomization.yaml \u4f86\u5ba2\u88fd\u5316\u8cc7\u6e90\uff0c\u5c0d\u65bc Fleet \u4f86\u8aaa\u7d66\u4e88\u4e00\u500b\u76f8\u5c0d\u7684\u8cc7\u6599\u593e\u4f4d\u7f6e\uff0c Fleet \u5c31\u6703\u5617\u8a66\u5c0b\u627e\u8a72\u8cc7\u6599\u593e\u5e95\u4e0b\u7684 kustomization.yaml \u4e26\u4e14\u5ba2\u88fd\u5316\u3002"),(0,a.kt)("p",null,"helm:\nHelm Chart \u672c\u8eab\u6709\u5169\u7a2e\u4f7f\u7528\u65b9\u5f0f\uff0c\u4e00\u7a2e\u662f\u8b80\u53d6\u9060\u65b9 Helm Server \u4e0a\u9762\u7684\u7269\u4ef6\uff0c\u4e00\u7a2e\u662f\u672c\u5730\u7684 Helm \u7269\u4ef6\uff0c\u56e0\u6b64 helm \u683c\u5f0f\u5167\u5c31\u6709 chart/repo \u7b49\u4e0d\u540c\u6b04\u4f4d\u8981\u4ea4\u4e92\u4f7f\u7528\u3002\n\u4e4b\u5f8c\u7684\u6587\u7ae0\u90fd\u6703\u6709\u9019\u4e9b\u7684\u4f7f\u7528\u7bc4\u4f8b\uff0c\u6240\u4ee5\u9019\u908a\u5c31\u4e0d\u8a73\u7d30\u5217\u51fa\u4f7f\u7528\u65b9\u5f0f\u3002"),(0,a.kt)("p",null,"\u5982\u679c\u63a1\u7528\u7684\u662f helm server \u7684\u8a71\uff0c\u9084\u53ef\u4ee5\u6307\u540d\u60f3\u8981\u5b89\u88dd\u7684\u7248\u672c\uff0c\u540c\u6642\u53ef\u4ee5\u900f\u904e\u5169\u7a2e\u4e0d\u540c\u7684\u65b9\u5f0f\u4f86\u5ba2\u88fd\u5316\uff0c\u4e00\u7a2e\u662f\u76f4\u63a5\u4f7f\u7528 values:.... \u7684\u683c\u5f0f\u4f86\u64b0\u5beb\uff0c\u9019\u7a2e\u65b9\u5f0f\u9069\u5408\u5c11\u91cf\u5ba2\u88fd\u5316\u7684\u9700\u6c42\uff0c\u7576\u5ba2\u88fd\u5316\u7684\u6578\u91cf\u904e\u591a\u6642\u5c31\u63a8\u85a6\u4f7f\u7528\u7b2c\u4e8c\u7a2e valuesFiles \u7684\u65b9\u5f0f\u4f86\u8f09\u5165\u5ba2\u88fd\u5316\u5167\u5bb9\u3002"),(0,a.kt)("p",null,"pause:\nPause \u7684\u7528\u9014\u662f\u8b93 Fleet \u55ae\u7d14\u505a\u7248\u672c\u6383\u63cf\u78ba\u8a8d\u6709\u65b0\u7248\u672c\uff0c\u4f46\u662f\u4e0d\u6703\u5e6b\u5fd9\u66f4\u65b0 Kubernetes \u5167\u7684\u8cc7\u6e90\uff0c\u7ba1\u7406\u4eba\u54e1\u9700\u8981\u81ea\u5df1\u624b\u52d5\u5f9e UI \u53bb\u9ede\u9078 force update \u4f86\u66f4\u65b0\u3002\n\u9810\u8a2d\u60c5\u6cc1\u4e0b\u90fd\u662f false\uff0c\u5c31\u4ee3\u8868 Fleet \u4e0d\u4f46\u6703\u78ba\u8a8d\u65b0\u820a\u5dee\u7570\u4e5f\u6703\u5e6b\u5fd9\u66f4\u65b0\u8cc7\u6e90\u3002"),(0,a.kt)("p",null,"rolloutStrategy:\nFleet \u7684\u7528\u9014\u662f\u7ba1\u7406\u5927\u91cf\u53e2\u96c6\u7684\u90e8\u7f72\uff0c\u56e0\u6b64\u5176\u63d0\u4f9b\u7684 rolloutStrategy \u7684\u9078\u9805\u4f86\u5ba2\u88fd\u5316\u53e2\u96c6\u9593\u7684\u66f4\u65b0\u7b56\u7565\uff0c\u57fa\u672c\u4e0a\u8ddf Kubernetes Deployment \u7684\u66f4\u65b0\u7b56\u7565\u975e\u5e38\u96f7\u540c\uff0c\u540c\u6642\u9593\u53ef\u4ee5\u6709\u591a\u5c11\u500b Cluster \u53ef\u4ee5\u8655\u65bc\u66f4\u65b0\u7684\u72c0\u614b\uff0c"),(0,a.kt)("p",null,"\u9019\u500b\u6b04\u4f4d\u4e2d\u4e3b\u8981\u5206\u6210\u5169\u5927\u985e"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u5982\u4f55\u5c07 Group \u5206\u985e\uff0c\u7a31\u70ba Partition"),(0,a.kt)("li",{parentName:"ol"},"\u5982\u4f55\u91dd\u5c0d\u6240\u6709\u7684 Group/Partition \u53bb\u8a2d\u5b9a\u66f4\u65b0\u7684\u6bd4\u7387")),(0,a.kt)("p",null,"targetCustomizations:\n\u9019\u500b\u6b04\u4f4d\u662f\u6574\u500b Fleet.yaml \u6700\u91cd\u8981\u7684\u90e8\u5206\n\u524d\u8ff0\u7684 Helm/Kustomization \u4ee3\u8868\u7684\u662f\u5982\u4f55\u6e32\u67d3\u7576\u524d\u8def\u5f91\u5e95\u4e0b\u7684 Kubernetes YAML \u6a94\u6848\u3002\n\u800c targetCustomizations \u5247\u662f\u8981\u5982\u4f55\u91dd\u5c0d\u4e0d\u540c\u7684 Kubernetes \u53e2\u96c6\u9032\u884c\u4e8c\u6b21\u5ba2\u88fd\u5316"),(0,a.kt)("p",null,"\u91cd\u8981\u7684\u662f\u4e0b\u65b9\u4e09\u500b\u9078\u9805\uff0c\u5982\u4f55\u9078\u64c7\u4e00\u500b Cluster\uff0c\u6709\u4e09\u7a2e\u4e0d\u540c\u65b9\u5f0f"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"clusterSelector"),(0,a.kt)("li",{parentName:"ol"},"clusterGroupSelector"),(0,a.kt)("li",{parentName:"ol"},"clusterGroup")),(0,a.kt)("p",null,"\u5176\u4e2d(2)/(3)\u5169\u500b\u90fd\u662f\u91dd\u5c0d Cluster Group \u76f4\u63a5\u8655\u7406\uff0c\u6240\u4ee5\u5982\u679c\u6709\u76f8\u540c\u985e\u4f3c\u7684 Cluster \u5c31\u53ef\u4ee5\u76f4\u63a5\u7fa4\u7d44\u8d77\u4f86\u9032\u884c\u8655\u7406\uff0c\u4e0d\u7136\u5c31\u8981\u4f7f\u7528\u7b2c\u4e00\u7a2e\u65b9\u5f0f\u900f\u904e selector \u7684\u65b9\u5f0f\u53bb\u8655\u7406\u3002\nclusterSelector \u7684\u65b9\u5f0f\u8ddf Kubernetes \u5167\u5927\u90e8\u5206\u7684\u8cc7\u6e90\u8655\u7406\u4e00\u6a23\uff0c\u90fd\u662f\u900f\u904e Label \u7684\u65b9\u5f0f\u53bb\u8655\u7406\u3002\nLabel \u53ef\u4ee5\u65bc UI \u65b9\u9762\u900f\u904e\u9ede\u9078\u7684\u65b9\u5f0f\u53bb\u52a0\u5165\u9019\u4e9b label\uff0c\u7576\u7136\u4e5f\u53ef\u4ee5\u900f\u904e Terraform \u53bb\u5275\u5efa RKE Cluster \u7684\u6642\u5019\u4e00\u8d77\u7d66\u4e88 Label\u3002"),(0,a.kt)("p",null,"\u5f9e\u7db2\u9801\u8981\u7d66\u4e88 Label \u7684\u8a71\uff0c\u5c31\u9ede\u9078\u5230 Cluster \u9801\u9762\uff0c\u627e\u5230\u76ee\u6a19\u7684 Cluster \uff0c\u9ede\u9078 Edit Config/Edit YAML \u90fd\u53ef\u4ee5\u3002"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://i.imgur.com/WPaL9gv.png",alt:null})),(0,a.kt)("p",null,"\u63a5\u8005\u65bc\u756b\u9762\u4e2d\u53bb\u586b\u5beb\u60f3\u8981\u4f7f\u7528\u7684 Label\uff0c\u9019\u4e9b Label \u5c31\u53ef\u4ee5\u65bc fleet.yaml \u53bb\u5ba2\u88fd\u5316\u9078\u64c7\u3002"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://i.imgur.com/mMjpf7X.png",alt:null})),(0,a.kt)("p",null,"\u5982\u679c\u60f3\u8981\u5617\u8a66 Cluster Group \u7684\u8a71\u4e5f\u53ef\u4ee5\u5617\u8a66\u5c07\u4e0d\u540c\u7684 Cluster \u7d66\u7fa4\u7d44\u8d77\u4f86\uff0c\u4e4b\u5f8c\u7684\u7bc4\u4f8b\u90fd\u53ef\u4ee5\u5617\u8a66\u770b\u770b\u3002"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://i.imgur.com/KsGCgPv.png",alt:null})),(0,a.kt)("h1",{id:"\u7c21\u55ae\u7bc4\u4f8b"},"\u7c21\u55ae\u7bc4\u4f8b"),(0,a.kt)("p",null,"\u4ee5\u4e0b\u7bc4\u4f8b\u7bc0\u9304\u81ea",(0,a.kt)("a",{parentName:"p",href:"https://github.com/rancher/fleet-examples/blob/master/multi-cluster/helm-external/fleet.yaml"},"\u5b98\u7db2\u7bc4\u4f8b")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml="},"namespace: fleet-mc-helm-external-example\nhelm:\n  chart: https://github.com/rancher/fleet-examples/releases/download/example/guestbook-0.0.0.tgz\ntargetCustomizations:\n- name: dev\n  helm:\n    values:\n      replication: false\n  clusterSelector:\n    matchLabels:\n      env: dev\n\n- name: test\n  helm:\n    values:\n      replicas: 3\n  clusterSelector:\n    matchLabels:\n      env: test\n\n- name: prod\n  helm:\n    values:\n      serviceType: LoadBalancer\n      replicas: 3\n  clusterSelector:\n    matchLabels:\n      env: prod\n")),(0,a.kt)("p",null,"\u4e0a\u8ff0\u7684 fleet.yaml \u975e\u5e38\u76f4\u89ba"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"\u4f7f\u7528 \u9060\u65b9\u7684 Helm Chart \u6a94\u6848\u4f5c\u70ba\u76ee\u6a19\u4f86\u6e90"),(0,a.kt)("li",{parentName:"ol"},"\u4f7f\u7528 env \u4f5c\u70ba label \u4f86\u6311\u9078\u4e09\u500b\u4e0d\u540c\u7684 cluster"),(0,a.kt)("li",{parentName:"ol"},"\u6bcf\u500b cluster \u4f7f\u7528\u6642\u90fd\u6703\u8a2d\u5b9a\u4e0d\u540c\u7684 value \u5167\u5bb9\u3002")),(0,a.kt)("p",null,"\u4e0b\u7bc7\u6587\u7ae0\u5c31\u6703\u5617\u8a66\u4f7f\u7528\u9019\u4e9b\u6982\u5ff5\u4f86\u5be6\u969b\u90e8\u7f72\u61c9\u7528\u7a0b\u5f0f"))}c.isMDXComponent=!0}}]);